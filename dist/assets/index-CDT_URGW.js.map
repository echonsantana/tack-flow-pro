{"version":3,"file":"index-CDT_URGW.js","sources":["../../src/App.js"],"sourcesContent":["\n/* ===== MODELS (Sin cambios) ===== */\nclass User {\n  constructor({ id, username, email, password, role = 'user', createdAt = null }) {\n    this.id = id || User.nextId();\n    this.username = username;\n    this.email = email;\n    this.password = password;\n    this.role = role;\n    this.createdAt = createdAt || new Date().toISOString();\n  }\n\n  static nextId() {\n    const raw = localStorage.getItem('sgt_lastUserId') || '0';\n    const next = parseInt(raw, 10) + 1;\n    localStorage.setItem('sgt_lastUserId', String(next));\n    return String(next);\n  }\n\n  isAdmin() {\n    return this.role === 'admin';\n  }\n}\n\nclass Task {\n  constructor({ \n    id, \n    title, \n    description = '', \n    priority = 'medium', \n    category = 'general', \n    dueDate = null, \n    status = 'pending', \n    userId, \n    tags = [], \n    subtasks = [],\n    reminder = null,\n    createdAt = null, \n    updatedAt = null \n  }) {\n    this.id = id || Task.nextId();\n    this.title = title;\n    this.description = description;\n    this.priority = priority;\n    this.category = category;\n    this.dueDate = dueDate;\n    this.status = status;\n    this.userId = userId;\n    this.tags = tags;\n    this.subtasks = subtasks;\n    this.reminder = reminder;\n    this.createdAt = createdAt || new Date().toISOString();\n    this.updatedAt = updatedAt || new Date().toISOString();\n  }\n\n  static nextId() {\n    const raw = localStorage.getItem('sgt_lastTaskId') || '0';\n    const next = parseInt(raw, 10) + 1;\n    localStorage.setItem('sgt_lastTaskId', String(next));\n    return String(next);\n  }\n\n  toggleSubtask(subtaskIndex) {\n    if (this.subtasks[subtaskIndex]) {\n      this.subtasks[subtaskIndex].completed = !this.subtasks[subtaskIndex].completed;\n      this.updatedAt = new Date().toISOString();\n    }\n  }\n\n  getCompletionPercentage() {\n    if (!this.subtasks.length) return this.status === 'completed' ? 100 : 0;\n    const completed = this.subtasks.filter(st => st.completed).length;\n    return Math.round((completed / this.subtasks.length) * 100);\n  }\n}\n\nclass Category {\n  constructor({ id, name, color = '#4361ee', userId, createdAt = null }) {\n    this.id = id || Category.nextId();\n    this.name = name;\n    this.color = color;\n    this.userId = userId;\n    this.createdAt = createdAt || new Date().toISOString();\n  }\n\n  static nextId() {\n    const raw = localStorage.getItem('sgt_lastCategoryId') || '0';\n    const next = parseInt(raw, 10) + 1;\n    localStorage.setItem('sgt_lastCategoryId', String(next));\n    return String(next);\n  }\n}\n\nclass Tag {\n  constructor({ id, name, color = '#4361ee', userId, createdAt = null }) {\n    this.id = id || Tag.nextId();\n    this.name = name;\n    this.color = color;\n    this.userId = userId;\n    this.createdAt = createdAt || new Date().toISOString();\n  }\n\n  static nextId() {\n    const raw = localStorage.getItem('sgt_lastTagId') || '0';\n    const next = parseInt(raw, 10) + 1;\n    localStorage.setItem('sgt_lastTagId', String(next));\n    return String(next);\n  }\n}\n\nclass Subtask {\n  constructor({ title, completed = false, createdAt = null }) {\n    this.id = Date.now() + Math.random().toString(36).substr(2, 9);\n    this.title = title;\n    this.completed = completed;\n    this.createdAt = createdAt || new Date().toISOString();\n  }\n}\n\nclass Notification {\n  constructor({ id, title, message, type = 'info', read = false, userId, taskId = null, createdAt = null }) {\n    this.id = id || Notification.nextId();\n    this.title = title;\n    this.message = message;\n    this.type = type;\n    this.read = read;\n    this.userId = userId;\n    this.taskId = taskId;\n    this.createdAt = createdAt || new Date().toISOString();\n  }\n\n  static nextId() {\n    const raw = localStorage.getItem('sgt_lastNotificationId') || '0';\n    const next = parseInt(raw, 10) + 1;\n    localStorage.setItem('sgt_lastNotificationId', String(next));\n    return String(next);\n  }\n}\n\nclass ColorSettings {\n  constructor({ \n    userId, \n    theme = 'light',\n    primaryColor = '#4361ee',\n    secondaryColor = '#64748b',\n    cardBg = '#ffffff',\n    textColor = '#1e293b',\n    borderColor = '#e2e8f0',\n    appBg = '#f8fafc',\n    accentColor = '#4cc9f0'\n  }) {\n    this.userId = userId;\n    this.theme = theme;\n    this.primaryColor = primaryColor;\n    this.secondaryColor = secondaryColor;\n    this.cardBg = cardBg;\n    this.textColor = textColor;\n    this.borderColor = borderColor;\n    this.appBg = appBg;\n    this.accentColor = accentColor;\n  }\n}\n\n/* ===== REPOSITORIES (Sin cambios) ===== */\nconst Repo = {\n  // Keys\n  USERS_KEY: 'sgt_users_v2',\n  TASKS_KEY: 'sgt_tasks_v2',\n  CATEGORIES_KEY: 'sgt_categories_v2',\n  TAGS_KEY: 'sgt_tags_v2',\n  NOTIFICATIONS_KEY: 'sgt_notifications_v1',\n  COLOR_SETTINGS_KEY: 'sgt_color_settings_v2',\n  SESSION_KEY: 'sgt_session_v2',\n  APP_SETTINGS_KEY: 'sgt_app_settings_v1',\n\n  // Users\n  loadUsers() {\n    const raw = localStorage.getItem(this.USERS_KEY);\n    return raw ? JSON.parse(raw).map(o => new User(o)) : [];\n  },\n  \n  saveUsers(users) {\n    localStorage.setItem(this.USERS_KEY, JSON.stringify(users));\n  },\n\n  // Tasks\n  loadTasks() {\n    const raw = localStorage.getItem(this.TASKS_KEY);\n    return raw ? JSON.parse(raw).map(o => new Task(o)) : [];\n  },\n  \n  saveTasks(tasks) {\n    localStorage.setItem(this.TASKS_KEY, JSON.stringify(tasks));\n  },\n\n  // Categories\n  loadCategories() {\n    const raw = localStorage.getItem(this.CATEGORIES_KEY);\n    return raw ? JSON.parse(raw).map(o => new Category(o)) : [];\n  },\n  \n  saveCategories(categories) {\n    localStorage.setItem(this.CATEGORIES_KEY, JSON.stringify(categories));\n  },\n\n  // Tags\n  loadTags() {\n    const raw = localStorage.getItem(this.TAGS_KEY);\n    return raw ? JSON.parse(raw).map(o => new Tag(o)) : [];\n  },\n  \n  saveTags(tags) {\n    localStorage.setItem(this.TAGS_KEY, JSON.stringify(tags));\n  },\n\n  // Notifications\n  loadNotifications() {\n    const raw = localStorage.getItem(this.NOTIFICATIONS_KEY);\n    return raw ? JSON.parse(raw).map(o => new Notification(o)) : [];\n  },\n  \n  saveNotifications(notifications) {\n    localStorage.setItem(this.NOTIFICATIONS_KEY, JSON.stringify(notifications));\n  },\n\n  // Color Settings\n  loadColorSettings() {\n    const raw = localStorage.getItem(this.COLOR_SETTINGS_KEY);\n    return raw ? JSON.parse(raw) : {};\n  },\n  \n  saveColorSettings(settings) {\n    localStorage.setItem(this.COLOR_SETTINGS_KEY, JSON.stringify(settings));\n  },\n\n  // App Settings\n  loadAppSettings() {\n    const raw = localStorage.getItem(this.APP_SETTINGS_KEY);\n    return raw ? JSON.parse(raw) : { notificationsEnabled: true, reminderTime: '09:00' };\n  },\n  \n  saveAppSettings(settings) {\n    localStorage.setItem(this.APP_SETTINGS_KEY, JSON.stringify(settings));\n  },\n\n  // Session\n  getSession() {\n    const raw = localStorage.getItem(this.SESSION_KEY);\n    return raw ? JSON.parse(raw) : null;\n  },\n  \n  setSession(user) {\n    localStorage.setItem(this.SESSION_KEY, JSON.stringify(user));\n  },\n  \n  clearSession() {\n    localStorage.removeItem(this.SESSION_KEY);\n  },\n\n  // Initialize default admin user\n  initDefaultAdmin() {\n    const users = this.loadUsers();\n    if (users.length === 0) {\n      const adminUser = new User({\n        username: 'admin',\n        email: 'admin@taskflow.com',\n        password: 'admin',\n        role: 'admin'\n      });\n      users.push(adminUser);\n      this.saveUsers(users);\n    }\n  }\n};\n\n// Initialize default admin on load\nRepo.initDefaultAdmin();\n\n/* ===== SERVICES (Sin cambios) ===== */\nconst AuthService = {\n  register(userData) {\n    const users = Repo.loadUsers();\n    \n    // Validate username\n    if (users.find(u => u.username === userData.username)) {\n      throw new Error('El nombre de usuario ya existe');\n    }\n    \n    // Validate email\n    if (users.find(u => u.email === userData.email)) {\n      throw new Error('El correo electrónico ya está registrado');\n    }\n\n    const user = new User(userData);\n    users.push(user);\n    Repo.saveUsers(users);\n    \n    // Create default categories for new user\n    const defaultCategories = [\n      { name: 'Personal', color: '#4361ee', userId: user.id },\n      { name: 'Trabajo', color: '#f72585', userId: user.id },\n      { name: 'Estudio', color: '#4cc9f0', userId: user.id },\n      { name: 'Hogar', color: '#f8961e', userId: user.id }\n    ];\n    \n    const categories = Repo.loadCategories();\n    defaultCategories.forEach(cat => categories.push(new Category(cat)));\n    Repo.saveCategories(categories);\n    \n    return {\n      id: user.id,\n      username: user.username,\n      email: user.email,\n      role: user.role,\n      createdAt: user.createdAt\n    };\n  },\n\n  login(username, password) {\n    const users = Repo.loadUsers();\n    const user = users.find(u => u.username === username);\n    \n    if (!user) {\n      throw new Error('Usuario no encontrado');\n    }\n    \n    if (user.password !== password) {\n      throw new Error('Contraseña incorrecta');\n    }\n\n    const { password: _, ...userWithoutPassword } = user;\n    Repo.setSession(userWithoutPassword);\n    return userWithoutPassword;\n  },\n\n  logout() {\n    Repo.clearSession();\n  },\n\n  getCurrentUser() {\n    return Repo.getSession();\n  },\n\n  updateProfile(userId, updates) {\n    const users = Repo.loadUsers();\n    const index = users.findIndex(u => u.id === userId);\n    if (index === -1) throw new Error('Usuario no encontrado');\n    \n    Object.assign(users[index], updates);\n    Repo.saveUsers(users);\n    \n    // Update session\n    const { password: _, ...userWithoutPassword } = users[index];\n    Repo.setSession(userWithoutPassword);\n    \n    return userWithoutPassword;\n  }\n};\n\nconst TaskService = {\n  getAll(userId) {\n    const tasks = Repo.loadTasks();\n    return tasks.filter(t => t.userId === userId);\n  },\n\n  create(data, userId) {\n    const tasks = Repo.loadTasks();\n    const task = new Task({ ...data, userId });\n    tasks.unshift(task);\n    Repo.saveTasks(tasks);\n    \n    // Create notification for due dates\n    if (task.dueDate) {\n      NotificationService.create({\n        title: 'Nueva tarea creada',\n        message: `\"${task.title}\" se ha creado con fecha límite ${new Date(task.dueDate).toLocaleDateString()}`,\n        type: 'info',\n        userId: userId,\n        taskId: task.id\n      });\n    }\n    \n    return task;\n  },\n\n  update(id, fields, userId) {\n    const tasks = Repo.loadTasks();\n    const index = tasks.findIndex(t => t.id === id && t.userId === userId);\n    if (index === -1) throw new Error('Tarea no encontrada');\n    \n    const oldTask = { ...tasks[index] };\n    Object.assign(tasks[index], fields);\n    tasks[index].updatedAt = new Date().toISOString();\n    Repo.saveTasks(tasks);\n    \n    // Create notification for status changes\n    if (fields.status && fields.status !== oldTask.status) {\n      const statusText = fields.status === 'completed' ? 'completada' : 'pendiente';\n      NotificationService.create({\n        title: 'Tarea actualizada',\n        message: `\"${tasks[index].title}\" ha sido marcada como ${statusText}`,\n        type: fields.status === 'completed' ? 'success' : 'info',\n        userId: userId,\n        taskId: tasks[index].id\n      });\n    }\n    \n    return tasks[index];\n  },\n\n  delete(id, userId) {\n    let tasks = Repo.loadTasks();\n    const task = tasks.find(t => t.id === id && t.userId === userId);\n    tasks = tasks.filter(t => !(t.id === id && t.userId === userId));\n    Repo.saveTasks(tasks);\n    \n    // Create notification\n    if (task) {\n      NotificationService.create({\n        title: 'Tarea eliminada',\n        message: `\"${task.title}\" ha sido eliminada`,\n        type: 'warning',\n        userId: userId\n      });\n    }\n  },\n\n  clearAll(userId) {\n    let tasks = Repo.loadTasks();\n    tasks = tasks.filter(t => t.userId !== userId);\n    Repo.saveTasks(tasks);\n    \n    NotificationService.create({\n      title: 'Todas las tareas eliminadas',\n      message: 'Se han eliminado todas las tareas',\n      type: 'warning',\n      userId: userId\n    });\n  },\n\n  toggleSubtask(taskId, subtaskIndex, userId) {\n    const tasks = Repo.loadTasks();\n    const index = tasks.findIndex(t => t.id === taskId && t.userId === userId);\n    if (index === -1) throw new Error('Tarea no encontrada');\n    \n    tasks[index].toggleSubtask(subtaskIndex);\n    Repo.saveTasks(tasks);\n    \n    return tasks[index];\n  },\n\n  getStats(userId) {\n    const tasks = this.getAll(userId);\n    const total = tasks.length;\n    const completed = tasks.filter(t => t.status === 'completed').length;\n    const pending = tasks.filter(t => t.status === 'pending').length;\n    const today = new Date().toISOString().split('T')[0];\n    const dueToday = tasks.filter(t => t.dueDate === today).length;\n    \n    return { total, completed, pending, dueToday };\n  }\n};\n\nconst CategoryService = {\n  getAll(userId) {\n    const categories = Repo.loadCategories();\n    return categories.filter(c => c.userId === userId);\n  },\n\n  create(data, userId) {\n    const categories = Repo.loadCategories();\n    const category = new Category({ ...data, userId });\n    categories.push(category);\n    Repo.saveCategories(categories);\n    return category;\n  },\n\n  update(id, fields, userId) {\n    const categories = Repo.loadCategories();\n    const index = categories.findIndex(c => c.id === id && c.userId === userId);\n    if (index === -1) throw new Error('Categoría no encontrada');\n    \n    Object.assign(categories[index], fields);\n    Repo.saveCategories(categories);\n    return categories[index];\n  },\n\n  delete(id, userId) {\n    let categories = Repo.loadCategories();\n    categories = categories.filter(c => !(c.id === id && c.userId === userId));\n    Repo.saveCategories(categories);\n    \n    // Update tasks using this category\n    const tasks = Repo.loadTasks();\n    tasks.forEach(task => {\n      if (task.category === id && task.userId === userId) {\n        task.category = 'general';\n      }\n    });\n    Repo.saveTasks(tasks);\n  },\n\n  getWithCount(userId) {\n    const categories = this.getAll(userId);\n    const tasks = TaskService.getAll(userId);\n    \n    return categories.map(category => ({\n      ...category,\n      count: tasks.filter(t => t.category === category.id).length\n    }));\n  }\n};\n\nconst TagService = {\n  getAll(userId) {\n    const tags = Repo.loadTags();\n    return tags.filter(t => t.userId === userId);\n  },\n\n  create(data, userId) {\n    const tags = Repo.loadTags();\n    \n    // Check for duplicate tag name\n    const existingTag = tags.find(t => \n      t.name.toLowerCase() === data.name.toLowerCase() && t.userId === userId\n    );\n    if (existingTag) {\n      throw new Error('Ya existe una etiqueta con este nombre');\n    }\n    \n    const tag = new Tag({ ...data, userId });\n    tags.push(tag);\n    Repo.saveTags(tags);\n    return tag;\n  },\n\n  update(id, fields, userId) {\n    const tags = Repo.loadTags();\n    const index = tags.findIndex(t => t.id === id && t.userId === userId);\n    if (index === -1) throw new Error('Etiqueta no encontrada');\n    \n    Object.assign(tags[index], fields);\n    Repo.saveTags(tags);\n    return tags[index];\n  },\n\n  delete(id, userId) {\n    let tags = Repo.loadTags();\n    tags = tags.filter(t => !(t.id === id && t.userId === userId));\n    Repo.saveTags(tags);\n    \n    // Remove tag from tasks\n    const tasks = Repo.loadTasks();\n    tasks.forEach(task => {\n      if (task.tags && task.tags.includes(id) && task.userId === userId) {\n        task.tags = task.tags.filter(tagId => tagId !== id);\n      }\n    });\n    Repo.saveTasks(tasks);\n  }\n};\n\nconst NotificationService = {\n  getAll(userId) {\n    const notifications = Repo.loadNotifications();\n    return notifications.filter(n => n.userId === userId);\n  },\n\n  create(data) {\n  const notifications = Repo.loadNotifications();\n  const notification = new Notification(data);\n  notifications.unshift(notification);\n  Repo.saveNotifications(notifications);\n  \n  // ⛔️⛔️⛔️ ELIMINAR ESTO COMPLETAMENTE ⛔️⛔️⛔️\n  // NO mostrar toast automáticamente\n  \n  // ✅ Solo actualizar el badge si la app está cargada\n  if (window.app && window.app.currentUser && data.userId === window.app.currentUser.id) {\n    // Actualizar badge asíncronamente para no bloquear\n    setTimeout(() => {\n      if (window.app && window.app.updateNotificationBadge) {\n        window.app.updateNotificationBadge();\n      }\n    }, 100);\n  }\n  \n  return notification;\n},\n\n  markAsRead(id, userId) {\n    const notifications = Repo.loadNotifications();\n    const index = notifications.findIndex(n => n.id === id && n.userId === userId);\n    if (index === -1) return;\n    \n    notifications[index].read = true;\n    Repo.saveNotifications(notifications);\n  },\n\n  markAllAsRead(userId) {\n    const notifications = Repo.loadNotifications();\n    notifications.forEach(n => {\n      if (n.userId === userId && !n.read) {\n        n.read = true;\n      }\n    });\n    Repo.saveNotifications(notifications);\n  },\n\n  delete(id, userId) {\n    let notifications = Repo.loadNotifications();\n    notifications = notifications.filter(n => !(n.id === id && n.userId === userId));\n    Repo.saveNotifications(notifications);\n  },\n\n  getUnreadCount(userId) {\n    const notifications = this.getAll(userId);\n    return notifications.filter(n => !n.read).length;\n  },\n\n  checkDueTasks(userId) {\n    const tasks = TaskService.getAll(userId);\n    const today = new Date().toISOString().split('T')[0];\n    const tomorrow = new Date(Date.now() + 86400000).toISOString().split('T')[0];\n    \n    // Check for tasks due today\n    const dueToday = tasks.filter(t => t.dueDate === today && t.status === 'pending');\n    dueToday.forEach(task => {\n      this.create({\n        title: 'Tarea vence hoy',\n        message: `\"${task.title}\" vence hoy`,\n        type: 'warning',\n        userId: userId,\n        taskId: task.id\n      });\n    });\n    \n    // Check for tasks due tomorrow\n    const dueTomorrow = tasks.filter(t => t.dueDate === tomorrow && t.status === 'pending');\n    dueTomorrow.forEach(task => {\n      this.create({\n        title: 'Tarea vence mañana',\n        message: `\"${task.title}\" vence mañana`,\n        type: 'info',\n        userId: userId,\n        taskId: task.id\n      });\n    });\n  }\n};\n\nconst ColorService = {\n  getSettings(userId) {\n    const allSettings = Repo.loadColorSettings();\n    return allSettings[userId] || new ColorSettings({ userId });\n  },\n\n  saveSettings(userId, settings) {\n    const allSettings = Repo.loadColorSettings();\n    allSettings[userId] = settings;\n    Repo.saveColorSettings(allSettings);\n  },\n\n  applyTheme(settings) {\n    const root = document.documentElement;\n    \n    // Apply CSS variables\n    root.style.setProperty('--primary-color', settings.primaryColor);\n    root.style.setProperty('--secondary-color', settings.secondaryColor);\n    root.style.setProperty('--card-bg', settings.cardBg);\n    root.style.setProperty('--bg-color', settings.appBg);\n    root.style.setProperty('--text-primary', settings.textColor);\n    root.style.setProperty('--border-color', settings.borderColor);\n    \n    // Set theme attribute\n    document.documentElement.setAttribute('data-theme', settings.theme);\n    \n    // Update primary color in meta tag for browser UI\n    const metaTheme = document.querySelector('meta[name=\"theme-color\"]');\n    if (metaTheme) {\n      metaTheme.setAttribute('content', settings.primaryColor);\n    }\n  },\n\n  getPreset(presetName) {\n    const presets = {\n      default: new ColorSettings({ userId: '' }),\n      dark: new ColorSettings({\n        userId: '',\n        theme: 'dark',\n        primaryColor: '#60a5fa',\n        secondaryColor: '#94a3b8',\n        cardBg: '#1e293b',\n        textColor: '#f1f5f9',\n        borderColor: '#334155',\n        appBg: '#0f172a',\n        accentColor: '#38bdf8'\n      }),\n      warm: new ColorSettings({\n        userId: '',\n        primaryColor: '#ea580c',\n        secondaryColor: '#9a3412',\n        cardBg: '#fef7ed',\n        textColor: '#431407',\n        borderColor: '#fdba74',\n        appBg: '#fffbeb',\n        accentColor: '#f97316'\n      }),\n      cool: new ColorSettings({\n        userId: '',\n        primaryColor: '#0ea5e9',\n        secondaryColor: '#0369a1',\n        cardBg: '#f0f9ff',\n        textColor: '#0c4a6e',\n        borderColor: '#7dd3fc',\n        appBg: '#f0fdfa',\n        accentColor: '#22d3ee'\n      }),\n      professional: new ColorSettings({\n        userId: '',\n        primaryColor: '#2563eb',\n        secondaryColor: '#475569',\n        cardBg: '#ffffff',\n        textColor: '#1e293b',\n        borderColor: '#e2e8f0',\n        appBg: '#f8fafc',\n        accentColor: '#3b82f6'\n      })\n    };\n    return presets[presetName] || presets.default;\n  }\n};\n\nconst AppSettingsService = {\n  getSettings() {\n    return Repo.loadAppSettings();\n  },\n\n  saveSettings(settings) {\n    Repo.saveAppSettings(settings);\n  },\n\n  updateSettings(updates) {\n    const settings = this.getSettings();\n    Object.assign(settings, updates);\n    this.saveSettings(settings);\n    return settings;\n  }\n};\n\n/* ===== API LAYER (Sin cambios) ===== */\nconst API = {\n  // Authentication\n  async register(userData) {\n    try {\n      const user = AuthService.register(userData);\n      return { success: true, user };\n    } catch (error) {\n      return { success: false, error: error.message };\n    }\n  },\n\n  async login(username, password) {\n    try {\n      const user = AuthService.login(username, password);\n      return { success: true, user };\n    } catch (error) {\n      return { success: false, error: error.message };\n    }\n  },\n\n  logout() {\n    AuthService.logout();\n    return Promise.resolve();\n  },\n\n  getCurrentUser() {\n    return Promise.resolve(AuthService.getCurrentUser());\n  },\n\n  // Tasks\n  async fetchTasks(filters = {}, userId) {\n    let tasks = TaskService.getAll(userId);\n    \n    // Apply filters\n    if (filters.status && filters.status !== 'all') {\n      tasks = tasks.filter(t => t.status === filters.status);\n    }\n    \n    if (filters.priority && filters.priority !== 'all') {\n      tasks = tasks.filter(t => t.priority === filters.priority);\n    }\n    \n    if (filters.category && filters.category !== 'all') {\n      tasks = tasks.filter(t => t.category === filters.category);\n    }\n    \n    if (filters.tag && filters.tag !== 'all') {\n      tasks = tasks.filter(t => t.tags && t.tags.includes(filters.tag));\n    }\n    \n    if (filters.dueDate) {\n      tasks = tasks.filter(t => t.dueDate === filters.dueDate);\n    }\n    \n    if (filters.search) {\n      const searchTerm = filters.search.toLowerCase();\n      tasks = tasks.filter(t => \n        t.title.toLowerCase().includes(searchTerm) || \n        (t.description && t.description.toLowerCase().includes(searchTerm))\n      );\n    }\n    \n    // Apply sorting\n    if (filters.sortBy === 'dueDate') {\n      tasks.sort((a, b) => new Date(a.dueDate || '9999-12-31') - new Date(b.dueDate || '9999-12-31'));\n    } else if (filters.sortBy === 'priority') {\n      const priorityOrder = { high: 0, medium: 1, low: 2 };\n      tasks.sort((a, b) => priorityOrder[a.priority] - priorityOrder[b.priority]);\n    } else {\n      tasks.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));\n    }\n    \n    return tasks;\n  },\n\n  createTask(data, userId) {\n    return Promise.resolve(TaskService.create(data, userId));\n  },\n\n  updateTask(id, fields, userId) {\n    return Promise.resolve(TaskService.update(id, fields, userId));\n  },\n\n  deleteTask(id, userId) {\n    return Promise.resolve(TaskService.delete(id, userId));\n  },\n\n  clearAllTasks(userId) {\n    TaskService.clearAll(userId);\n    return Promise.resolve();\n  },\n\n  toggleSubtask(taskId, subtaskIndex, userId) {\n    return Promise.resolve(TaskService.toggleSubtask(taskId, subtaskIndex, userId));\n  },\n\n  getTaskStats(userId) {\n    return Promise.resolve(TaskService.getStats(userId));\n  },\n\n  // Categories\n  fetchCategories(userId) {\n    return Promise.resolve(CategoryService.getAll(userId));\n  },\n\n  fetchCategoriesWithCount(userId) {\n    return Promise.resolve(CategoryService.getWithCount(userId));\n  },\n\n  createCategory(data, userId) {\n    return Promise.resolve(CategoryService.create(data, userId));\n  },\n\n  updateCategory(id, fields, userId) {\n    return Promise.resolve(CategoryService.update(id, fields, userId));\n  },\n\n  deleteCategory(id, userId) {\n    return Promise.resolve(CategoryService.delete(id, userId));\n  },\n\n  // Tags\n  fetchTags(userId) {\n    return Promise.resolve(TagService.getAll(userId));\n  },\n\n  createTag(data, userId) {\n    return Promise.resolve(TagService.create(data, userId));\n  },\n\n  updateTag(id, fields, userId) {\n    return Promise.resolve(TagService.update(id, fields, userId));\n  },\n\n  deleteTag(id, userId) {\n    return Promise.resolve(TagService.delete(id, userId));\n  },\n\n  // Notifications\n  fetchNotifications(userId) {\n    return Promise.resolve(NotificationService.getAll(userId));\n  },\n\n  markNotificationAsRead(id, userId) {\n    return Promise.resolve(NotificationService.markAsRead(id, userId));\n  },\n\n  markAllNotificationsAsRead(userId) {\n    return Promise.resolve(NotificationService.markAllAsRead(userId));\n  },\n\n  deleteNotification(id, userId) {\n    return Promise.resolve(NotificationService.delete(id, userId));\n  },\n\n  getUnreadNotificationCount(userId) {\n    return Promise.resolve(NotificationService.getUnreadCount(userId));\n  },\n\n  // Color Settings\n  getColorSettings(userId) {\n    return Promise.resolve(ColorService.getSettings(userId));\n  },\n\n  saveColorSettings(userId, settings) {\n    ColorService.saveSettings(userId, settings);\n    ColorService.applyTheme(settings);\n    return Promise.resolve();\n  },\n\n  // App Settings\n  getAppSettings() {\n    return Promise.resolve(AppSettingsService.getSettings());\n  },\n\n  saveAppSettings(settings) {\n    return Promise.resolve(AppSettingsService.saveSettings(settings));\n  },\n\n  // Export\n  exportTasks(format = 'json', userId) {\n    const tasks = TaskService.getAll(userId);\n    const categories = CategoryService.getAll(userId);\n    const tags = TagService.getAll(userId);\n    \n    const data = {\n      tasks,\n      categories,\n      tags,\n      exportedAt: new Date().toISOString(),\n      version: '2.0',\n      app: 'TaskFlow Pro'\n    };\n\n    if (format === 'json') {\n      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\n      return Promise.resolve(URL.createObjectURL(blob));\n    } else if (format === 'csv') {\n      const headers = ['ID', 'Título', 'Descripción', 'Prioridad', 'Categoría', 'Estado', 'Fecha Límite', 'Etiquetas', 'Creado', 'Actualizado'];\n      const csvRows = [\n        headers.join(','),\n        ...tasks.map(t => [\n          t.id,\n          `\"${t.title.replace(/\"/g, '\"\"')}\"`,\n          `\"${(t.description || '').replace(/\"/g, '\"\"')}\"`,\n          t.priority,\n          t.category,\n          t.status,\n          t.dueDate || '',\n          t.tags ? `\"${t.tags.join(';')}\"` : '',\n          t.createdAt,\n          t.updatedAt\n        ].join(','))\n      ];\n      const csv = csvRows.join('\\n');\n      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n      return Promise.resolve(URL.createObjectURL(blob));\n    }\n  }\n};\n\n/* ===== UI COMPONENTS ===== */\nclass ToastManager {\n  static show(title, message, type = 'info', duration = 3000) {\n    const container = document.getElementById('toastContainer');\n    if (!container) return;\n    \n    const toast = document.createElement('div');\n    toast.className = `toast ${type}`;\n    \n    const icon = {\n      success: 'fas fa-check-circle',\n      error: 'fas fa-exclamation-circle',\n      warning: 'fas fa-exclamation-triangle',\n      info: 'fas fa-info-circle'\n    }[type] || 'fas fa-info-circle';\n    \n    toast.innerHTML = `\n      <i class=\"${icon}\"></i>\n      <div class=\"toast-content\">\n        <div class=\"toast-title\">${title}</div>\n        <div class=\"toast-message\">${message}</div>\n      </div>\n      <button class=\"toast-close\">\n        <i class=\"fas fa-times\"></i>\n      </button>\n    `;\n    \n    container.appendChild(toast);\n    \n    // Remove toast after duration\n    const removeToast = () => {\n      toast.style.opacity = '0';\n      toast.style.transform = 'translateY(100%)';\n      setTimeout(() => {\n        if (toast.parentElement) {\n          toast.remove();\n        }\n      }, 300);\n    };\n    \n    // Close button\n    toast.querySelector('.toast-close').addEventListener('click', removeToast);\n    \n    // Auto remove\n    if (duration > 0) {\n      setTimeout(removeToast, duration);\n    }\n    \n    return toast;\n  }\n}\n\nclass LoadingManager {\n  static show() {\n    const spinner = document.getElementById('loadingSpinner');\n    if (spinner) {\n      spinner.style.opacity = '0';\n      spinner.classList.remove('hidden');\n      setTimeout(() => spinner.style.opacity = '1', 10);\n    }\n  }\n  \n  static hide() {\n    const spinner = document.getElementById('loadingSpinner');\n    if (spinner) {\n      spinner.style.opacity = '0';\n      setTimeout(() => spinner.classList.add('hidden'), 300);\n    }\n  }\n}\n\n/* ===== MAIN APP CLASS CON MEJORAS ===== */\nclass App {\n  constructor() {\n    this.currentUser = null;\n    this.categories = [];\n    this.tags = [];\n    this.notifications = [];\n    this.currentTaskTags = [];\n    this.currentTaskSubtasks = [];\n    this.colorSettings = null;\n    this.appSettings = null;\n    this.viewMode = 'grid';\n    this.init();\n  }\n\n  async init() {\n    LoadingManager.show();\n    \n    // Initialize app\n    await this.checkAuth();\n    await this.loadAppSettings();\n    this.setupEventListeners();\n    \n    // Nuevas características UX\n    this.setupKeyboardShortcuts();\n    this.createQuickActions();\n    this.loadViewPreferences();\n    \n    // Check for due tasks notifications\n    if (this.currentUser) {\n      NotificationService.checkDueTasks(this.currentUser.id);\n    }\n    \n    LoadingManager.hide();\n  }\n\n  // NUEVO: Cargar preferencias de vista\n  async loadViewPreferences() {\n    const prefs = JSON.parse(localStorage.getItem('taskflow_view_prefs') || '{}');\n    this.viewMode = prefs.viewMode || 'grid';\n    this.setViewMode(this.viewMode);\n  }\n\n  // NUEVO: Configurar atajos de teclado\n  setupKeyboardShortcuts() {\n    document.addEventListener('keydown', (e) => {\n      if (e.ctrlKey && e.key === 'n') {\n        e.preventDefault();\n        this.openNewTask();\n      }\n      if (e.ctrlKey && e.key === 'f') {\n        e.preventDefault();\n        document.getElementById('search')?.focus();\n      }\n      if (e.key === 'Escape') {\n        this.hideModal();\n        this.closeTaskDetail();\n      }\n      // Alt + N para notificaciones\n      if (e.altKey && e.key === 'n') {\n        e.preventDefault();\n        this.toggleNotifications();\n      }\n    });\n  }\n\n  // NUEVO: Crear acciones rápidas flotantes\n  createQuickActions() {\n    const quickActions = document.createElement('div');\n    quickActions.className = 'quick-actions';\n    quickActions.innerHTML = `\n      <button class=\"quick-action-btn\" title=\"Nueva tarea\" id=\"quickActionNewTask\">\n        <i class=\"fas fa-plus\"></i>\n      </button>\n      <button class=\"quick-action-btn\" title=\"Filtros rápidos\" id=\"quickActionFilter\">\n        <i class=\"fas fa-filter\"></i>\n      </button>\n      <button class=\"quick-action-btn\" title=\"Buscar\" id=\"quickActionSearch\">\n        <i class=\"fas fa-search\"></i>\n      </button>\n    `;\n    document.body.appendChild(quickActions);\n    \n    // Event listeners para quick actions\n    document.getElementById('quickActionNewTask').addEventListener('click', () => this.openNewTask());\n    document.getElementById('quickActionFilter').addEventListener('click', () => {\n      document.querySelector('.filters-panel')?.scrollIntoView({ behavior: 'smooth' });\n    });\n    document.getElementById('quickActionSearch').addEventListener('click', () => {\n      document.getElementById('search')?.focus();\n    });\n  }\n\n  async checkAuth() {\n    this.currentUser = await API.getCurrentUser();\n    if (this.currentUser) {\n      await this.initializeApp();\n    } else {\n      this.showLogin();\n    }\n  }\n\n  async initializeApp() {\n    this.showApp();\n    \n    // Load user data\n    await Promise.all([\n      this.loadCategories(),\n      this.loadTags(),\n      this.loadNotifications(),\n      this.loadUserColors()\n    ]);\n    \n    // Update stats\n    await this.updateStats();\n    \n    // Load tasks\n    await this.refresh();\n    \n    // Apply theme\n    this.applyTheme();\n    \n    // Schedule next notification check\n    setTimeout(() => {\n      if (this.currentUser) {\n        NotificationService.checkDueTasks(this.currentUser.id);\n      }\n    }, 60000);\n  }\n\n  async loadAppSettings() {\n    this.appSettings = await API.getAppSettings();\n  }\n\n  async loadCategories() {\n    this.categories = await API.fetchCategories(this.currentUser.id);\n    await this.renderCategorySidebar();\n    this.renderCategoryFilters();\n  }\n\n  async loadTags() {\n    this.tags = await API.fetchTags(this.currentUser.id);\n    this.renderTagFilters();\n  }\n\n  async loadNotifications() {\n    this.notifications = await API.fetchNotifications(this.currentUser.id);\n    this.updateNotificationBadge();\n    this.renderNotifications();\n  }\n\n  async loadUserColors() {\n    this.colorSettings = await API.getColorSettings(this.currentUser.id);\n  }\n\n  async updateStats() {\n    if (!this.currentUser) return;\n    \n    const stats = await API.getTaskStats(this.currentUser.id);\n    \n    document.getElementById('pendingCount').textContent = stats.pending;\n    document.getElementById('completedCount').textContent = stats.completed;\n    document.getElementById('todayCount').textContent = stats.dueToday;\n    \n    // Update completion progress\n    const completionRate = stats.total > 0 ? Math.round((stats.completed / stats.total) * 100) : 0;\n    const progressCircle = document.getElementById('completionProgress');\n    if (progressCircle) {\n      progressCircle.style.background = `conic-gradient(var(--primary-color) 0% ${completionRate}%, var(--border-color) ${completionRate}% 100%)`;\n      progressCircle.querySelector('.progress-value').textContent = `${completionRate}%`;\n    }\n  }\n\n  async updateNotificationBadge() {\n    const count = await API.getUnreadNotificationCount(this.currentUser.id);\n    const badge = document.getElementById('notificationCount');\n    \n    if (count > 0) {\n      badge.textContent = count > 9 ? '9+' : count;\n      badge.classList.remove('hidden');\n    } else {\n      badge.classList.add('hidden');\n    }\n  }\n\n  applyTheme() {\n    if (this.colorSettings) {\n      ColorService.applyTheme(this.colorSettings);\n    }\n  }\n\n  // UI Navigation\n  showLogin() {\n    document.getElementById('loginScreen').classList.remove('hidden');\n    document.getElementById('registerScreen').classList.add('hidden');\n    document.getElementById('app').classList.add('hidden');\n    document.querySelector('.quick-actions')?.classList.add('hidden');\n  }\n\n  showRegister() {\n    document.getElementById('loginScreen').classList.add('hidden');\n    document.getElementById('registerScreen').classList.remove('hidden');\n    document.getElementById('app').classList.add('hidden');\n    document.querySelector('.quick-actions')?.classList.add('hidden');\n  }\n\n  showApp() {\n    document.getElementById('loginScreen').classList.add('hidden');\n    document.getElementById('registerScreen').classList.add('hidden');\n    document.getElementById('app').classList.remove('hidden');\n    document.querySelector('.quick-actions')?.classList.remove('hidden');\n    \n    // Update user info\n    document.getElementById('userWelcome').textContent = this.currentUser.username;\n    document.getElementById('dropdownUsername').textContent = this.currentUser.username;\n    document.getElementById('dropdownEmail').textContent = this.currentUser.email;\n  }\n\n  // Event Listeners - MEJORADOS con nuevas características\n  setupEventListeners() {\n    // Auth events\n    document.getElementById('loginForm').addEventListener('submit', (e) => this.handleLogin(e));\n    document.getElementById('registerForm').addEventListener('submit', (e) => this.handleRegister(e));\n    document.getElementById('showRegister').addEventListener('click', (e) => { \n    e.preventDefault(); \n    document.getElementById('loginScreen').classList.add('hidden');\n    document.getElementById('registerScreen').classList.remove('hidden');\n});\n    document.getElementById('showLogin').addEventListener('click', (e) => { e.preventDefault(); this.showLogin(); });\n    \n    // Header actions\n    document.getElementById('themeToggle').addEventListener('click', () => this.toggleTheme());\n    document.getElementById('notificationBtn').addEventListener('click', () => this.toggleNotifications());\n    document.getElementById('quickTaskBtn').addEventListener('click', () => this.openNewTask());\n    document.getElementById('userMenuBtn').addEventListener('click', () => this.toggleUserDropdown());\n    document.getElementById('logoutBtn').addEventListener('click', () => this.logout());\n    \n    // Task actions\n    document.getElementById('newTaskBtn').addEventListener('click', () => this.openNewTask());\n    document.getElementById('exportBtn').addEventListener('click', () => this.exportTasks());\n    \n    // Filters\n    document.getElementById('search').addEventListener('input', () => this.debouncedRefresh());\n    document.getElementById('searchBtn').addEventListener('click', () => this.refresh());\n    document.getElementById('clearSearch').addEventListener('click', () => {\n      document.getElementById('search').value = '';\n      this.refresh();\n    });\n    \n    document.getElementById('search').addEventListener('keydown', (e) => {\n      if (e.key === 'Enter') {\n        this.refresh();\n      }\n    });\n    \n    ['filterStatus', 'filterPriority', 'filterCategory', 'filterTags', 'filterDate'].forEach(id => {\n      const element = document.getElementById(id);\n      if (element) {\n        element.addEventListener('change', () => this.refresh());\n      }\n    });\n    \n    document.getElementById('clearFilters').addEventListener('click', () => this.clearFilters());\n    \n    // View controls\n    document.getElementById('viewGrid').addEventListener('click', () => this.setViewMode('grid'));\n    document.getElementById('viewList').addEventListener('click', () => this.setViewMode('list'));\n    document.getElementById('sortTasks').addEventListener('click', () => this.showSortOptions());\n    \n    // Category sidebar\n    document.getElementById('addCategoryBtn').addEventListener('click', () => this.openCategoryModal());\n    \n    // Modals\n    document.getElementById('cancelBtn').addEventListener('click', () => this.hideModal());\n    document.getElementById('cancelBtn2').addEventListener('click', () => this.hideModal());\n    document.getElementById('taskForm').addEventListener('submit', (e) => this.handleTaskSubmit(e));\n    document.getElementById('deleteTaskBtn').addEventListener('click', () => this.deleteCurrentTask());\n    \n    // Tag system\n    document.getElementById('tagInput').addEventListener('input', (e) => this.showTagSuggestions(e));\n    document.getElementById('tagInput').addEventListener('keydown', (e) => this.handleTagInput(e));\n    document.getElementById('showTagsManager').addEventListener('click', () => this.openTagsModal());\n    \n    // Subtasks\n    document.getElementById('addSubtaskBtn').addEventListener('click', () => this.addSubtask());\n    document.getElementById('subtaskInput').addEventListener('keydown', (e) => {\n      if (e.key === 'Enter') {\n        e.preventDefault();\n        this.addSubtask();\n      }\n    });\n    \n    // Priority selector\n    document.querySelectorAll('.priority-option').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        document.querySelectorAll('.priority-option').forEach(b => b.classList.remove('active'));\n        e.target.closest('.priority-option').classList.add('active');\n        document.getElementById('priority').value = e.target.closest('.priority-option').dataset.value;\n      });\n    });\n    \n    // Task detail\n    document.getElementById('closeTaskDetail').addEventListener('click', () => this.closeTaskDetail());\n    document.getElementById('taskDetailModal').addEventListener('click', (e) => {\n      if (e.target === document.getElementById('taskDetailModal')) {\n        this.closeTaskDetail();\n      }\n    });\n    \n    // Color settings\n    document.getElementById('colorSettingsBtn').addEventListener('click', () => this.openColorSettings());\n    document.getElementById('saveColorsBtn').addEventListener('click', () => this.saveColorSettings());\n    document.getElementById('cancelColorsBtn').addEventListener('click', () => {\n      if (this.colorSettings) {\n        ColorService.applyTheme(this.colorSettings);\n      }\n      document.getElementById('colorSettingsModal').classList.add('hidden');\n    });\n    document.getElementById('resetColorsBtn').addEventListener('click', () => this.resetColors());\n    \n    // Color preset buttons\n    document.querySelectorAll('.preset-btn').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const presetName = e.target.closest('.preset-btn').dataset.preset;\n        this.applyColorPreset(presetName);\n      });\n    });\n    \n    // Real-time color preview\n    ['primaryColor', 'secondaryColor', 'cardBgColor', 'appBgColor'].forEach(id => {\n      const element = document.getElementById(id);\n      if (element) {\n        element.addEventListener('input', (e) => {\n          this.previewColorChange(e.target.id, e.target.value);\n        });\n      }\n    });\n    \n    // Close dropdowns when clicking outside\n    document.addEventListener('click', (e) => {\n      if (!e.target.closest('.user-menu')) {\n        document.getElementById('userDropdown').classList.add('hidden');\n      }\n      if (!e.target.closest('.notification-center') && !e.target.closest('#notificationBtn')) {\n        document.getElementById('notificationCenter').classList.add('hidden');\n      }\n    });\n    \n    // Close notifications panel\n    const closeNotificationsBtn = document.getElementById('closeNotifications');\n    if (closeNotificationsBtn) {\n      closeNotificationsBtn.addEventListener('click', () => {\n        document.getElementById('notificationCenter').classList.add('hidden');\n      });\n    }\n    \n    // Close tags modal\n    document.getElementById('closeTagsModal').addEventListener('click', () => {\n      document.getElementById('tagsModal').classList.add('hidden');\n    });\n    \n    // Add tag button\n    document.getElementById('addTagBtn').addEventListener('click', () => this.addNewTag());\n    \n    // Close category modal\n    document.getElementById('closeCategoryModal').addEventListener('click', () => {\n      document.getElementById('categoryModal').classList.add('hidden');\n    });\n    \n    // Add category button in modal\n    const addCategoryBtnModal = document.getElementById('addCategoryBtnModal');\n    if (addCategoryBtnModal) {\n      addCategoryBtnModal.addEventListener('click', () => this.addNewCategory());\n    }\n    \n    // Manage tags button in dropdown\n    document.getElementById('manageTagsBtn').addEventListener('click', () => this.openTagsModal());\n    \n    // NUEVO: Guardar preferencias de vista al cambiar\n    document.getElementById('viewGrid').addEventListener('click', () => {\n      this.saveViewPreference('viewMode', 'grid');\n    });\n    \n    document.getElementById('viewList').addEventListener('click', () => {\n      this.saveViewPreference('viewMode', 'list');\n    });\n  }\n\n  // NUEVO: Guardar preferencias\n  saveViewPreference(key, value) {\n    const prefs = JSON.parse(localStorage.getItem('taskflow_view_prefs') || '{}');\n    prefs[key] = value;\n    localStorage.setItem('taskflow_view_prefs', JSON.stringify(prefs));\n  }\n\n  // Debounce function for search\n  debouncedRefresh = this.debounce(() => this.refresh(), 300);\n\n  debounce(func, wait) {\n    let timeout;\n    return function executedFunction(...args) {\n      const later = () => {\n        clearTimeout(timeout);\n        func(...args);\n      };\n      clearTimeout(timeout);\n      timeout = setTimeout(later, wait);\n    };\n  }\n\n  // Auth Handlers\n  async handleLogin(e) {\n    e.preventDefault();\n    LoadingManager.show();\n\n    const username = document.getElementById('username').value;\n    const password = document.getElementById('password').value;\n    \n    const result = await API.login(username, password);\n    if (result.success) {\n      this.currentUser = result.user;\n      await this.initializeApp();\n      this.showToast('¡Bienvenido!', `Hola ${this.currentUser.username}`, 'success');\n    } else {\n      this.showToast('Error de inicio de sesión', result.error, 'error');\n    }\n    \n    LoadingManager.hide();\n  }\n\n  async handleRegister(e) {\n    e.preventDefault();\n    LoadingManager.show();\n    \n    const username = document.getElementById('regUsername').value;\n    const email = document.getElementById('regEmail').value;\n    const password = document.getElementById('regPassword').value;\n    const confirmPassword = document.getElementById('regConfirmPassword').value;\n    \n    if (password !== confirmPassword) {\n      this.showToast('Error de registro', 'Las contraseñas no coinciden', 'error');\n      LoadingManager.hide();\n      return;\n    }\n    \n    const result = await API.register({ username, email, password });\n    if (result.success) {\n      this.showToast('¡Cuenta creada!', 'Tu cuenta ha sido creada exitosamente. Ahora puedes iniciar sesión.', 'success');\n      \n      // Limpiar el formulario\n      document.getElementById('registerForm').reset();\n      \n      // Mostrar pantalla de login\n      this.showLogin();\n    } else {\n      this.showToast('Error de registro', result.error, 'error');\n    }\n    \n    LoadingManager.hide();\n  }\n\n  async logout() {\n    await API.logout();\n    this.currentUser = null;\n    this.showLogin();\n    this.showToast('Sesión cerrada', 'Has cerrado sesión correctamente', 'info');\n  }\n\n  toggleUserDropdown() {\n    const dropdown = document.getElementById('userDropdown');\n    dropdown.classList.toggle('hidden');\n  }\n\n  // Task Management\n  async openNewTask() {\n    document.getElementById('modalTitle').innerHTML = '<i class=\"fas fa-tasks\"></i> Nueva Tarea';\n    document.getElementById('taskForm').reset();\n    document.getElementById('taskId').value = '';\n    document.getElementById('category').value = 'general';\n    document.getElementById('priority').value = 'medium';\n    document.getElementById('reminder').value = 'none';\n    \n    // Reset priority selector\n    document.querySelectorAll('.priority-option').forEach(btn => {\n      btn.classList.remove('active');\n      if (btn.dataset.value === 'medium') {\n        btn.classList.add('active');\n      }\n    });\n    \n    // Clear tags and subtasks\n    this.currentTaskTags = [];\n    this.currentTaskSubtasks = [];\n    this.renderTaskTags();\n    this.renderSubtasks();\n    \n    // Hide delete button for new tasks\n    document.getElementById('deleteTaskBtn').classList.add('hidden');\n    \n    this.showModal();\n  }\n\n  async openEditTask(task) {\n    document.getElementById('modalTitle').innerHTML = '<i class=\"fas fa-edit\"></i> Editar Tarea';\n    document.getElementById('taskId').value = task.id;\n    document.getElementById('title').value = task.title;\n    document.getElementById('description').value = task.description || '';\n    document.getElementById('priority').value = task.priority || 'medium';\n    document.getElementById('category').value = task.category || 'general';\n    document.getElementById('dueDate').value = task.dueDate || '';\n    document.getElementById('reminder').value = task.reminder || 'none';\n    \n    // Update priority selector\n    document.querySelectorAll('.priority-option').forEach(btn => {\n      btn.classList.remove('active');\n      if (btn.dataset.value === (task.priority || 'medium')) {\n        btn.classList.add('active');\n      }\n    });\n    \n    // Load tags and subtasks\n    this.currentTaskTags = task.tags || [];\n    this.currentTaskSubtasks = task.subtasks || [];\n    this.renderTaskTags();\n    this.renderSubtasks();\n    \n    // Show delete button for existing tasks\n    document.getElementById('deleteTaskBtn').classList.remove('hidden');\n    \n    this.showModal();\n  }\n\n  showModal() {\n    document.getElementById('modal').classList.remove('hidden');\n  }\n\n  hideModal() {\n    document.getElementById('modal').classList.add('hidden');\n  }\n\n  async handleTaskSubmit(e) {\n    e.preventDefault();\n    LoadingManager.show();\n    \n    const id = document.getElementById('taskId').value;\n    const data = {\n      title: document.getElementById('title').value.trim(),\n      description: document.getElementById('description').value.trim(),\n      priority: document.getElementById('priority').value,\n      category: document.getElementById('category').value,\n      dueDate: document.getElementById('dueDate').value || null,\n      reminder: document.getElementById('reminder').value !== 'none' ? document.getElementById('reminder').value : null,\n      tags: this.currentTaskTags,\n      subtasks: this.currentTaskSubtasks\n    };\n    \n    if (!data.title) {\n      this.showToast('Error', 'El título es obligatorio', 'error');\n      LoadingManager.hide();\n      return;\n    }\n    \n    try {\n      if (id) {\n        await API.updateTask(id, data, this.currentUser.id);\n        this.showToast('Tarea actualizada', 'La tarea se ha actualizado correctamente', 'success');\n      } else {\n        await API.createTask(data, this.currentUser.id);\n        this.showToast('Tarea creada', 'La tarea se ha creado correctamente', 'success');\n      }\n      \n      this.hideModal();\n      await this.refresh();\n      await this.updateStats();\n    } catch (error) {\n      this.showToast('Error', 'No se pudo guardar la tarea', 'error');\n    }\n    \n    LoadingManager.hide();\n  }\n\n  // MODIFICADO: Reemplazar prompt por modal\n  async deleteCurrentTask() {\n    const taskId = document.getElementById('taskId').value;\n    const taskTitle = document.getElementById('title').value;\n    \n    if (!taskId) return;\n    \n    // Mostrar modal de confirmación en lugar de prompt\n    this.showDeleteConfirmation(taskId, taskTitle, true); // true indica que es del modal de edición\n  }\n\n  // NUEVO: Mostrar modal de confirmación para eliminar\n  showDeleteConfirmation(taskId, taskTitle = 'esta tarea', fromModal = false) {\n    // Crear modal de confirmación\n    const modal = document.createElement('div');\n    modal.className = 'modal';\n    modal.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.5);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 2000;\n      backdrop-filter: blur(4px);\n      animation: fadeIn 0.2s ease;\n    `;\n    \n    modal.innerHTML = `\n      <div style=\"\n        background: var(--card-bg);\n        padding: 25px;\n        border-radius: var(--radius-lg);\n        width: 90%;\n        max-width: 400px;\n        box-shadow: var(--shadow-xl);\n        border: 2px solid var(--danger-color);\n        animation: slideUp 0.3s ease;\n      \">\n        <div style=\"text-align: center; margin-bottom: 20px;\">\n          <div style=\"font-size: 48px; color: var(--danger-color); margin-bottom: 15px;\">\n            <i class=\"fas fa-exclamation-triangle\"></i>\n          </div>\n          <h3 style=\"margin-bottom: 10px; color: var(--text-primary); font-size: 1.25rem;\">\n            ¿Eliminar tarea?\n          </h3>\n          <p style=\"color: var(--text-secondary); margin-bottom: 25px; line-height: 1.5;\">\n            Se eliminará permanentemente la tarea: <strong>\"${this.escapeHtml(taskTitle)}\"</strong>.\n            <br><span style=\"color: var(--danger-color); font-size: 0.9rem;\">Esta acción no se puede deshacer.</span>\n          </p>\n        </div>\n        \n        <div style=\"display: flex; gap: 10px;\">\n          <button id=\"cancelDeleteBtn\" style=\"\n            flex: 1;\n            padding: 12px 20px;\n            background: var(--bg-color);\n            color: var(--text-secondary);\n            border: 2px solid var(--border-color);\n            border-radius: var(--radius-md);\n            cursor: pointer;\n            font-weight: 600;\n            transition: all var(--transition-fast);\n          \">Cancelar</button>\n          <button id=\"confirmDeleteBtn\" style=\"\n            flex: 1;\n            padding: 12px 20px;\n            background: var(--danger-color);\n            color: white;\n            border: none;\n            border-radius: var(--radius-md);\n            cursor: pointer;\n            font-weight: 600;\n            transition: all var(--transition-fast);\n          \">Eliminar</button>\n        </div>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Estilos para animaciones\n    const style = document.createElement('style');\n    style.textContent = `\n      @keyframes fadeIn {\n        from { opacity: 0; }\n        to { opacity: 1; }\n      }\n      @keyframes slideUp {\n        from {\n          opacity: 0;\n          transform: translateY(20px);\n        }\n        to {\n          opacity: 1;\n          transform: translateY(0);\n        }\n      }\n      #cancelDeleteBtn:hover {\n        background: var(--border-color) !important;\n        transform: translateY(-1px);\n      }\n      #confirmDeleteBtn:hover {\n        background: var(--danger-light) !important;\n        transform: translateY(-1px);\n        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);\n      }\n    `;\n    document.head.appendChild(style);\n    \n    // Eventos del modal\n    const cancelBtn = document.getElementById('cancelDeleteBtn');\n    const confirmBtn = document.getElementById('confirmDeleteBtn');\n    \n    const closeModal = () => {\n      document.body.removeChild(modal);\n      document.head.removeChild(style);\n    };\n    \n    cancelBtn.addEventListener('click', closeModal);\n    \n    confirmBtn.addEventListener('click', async () => {\n      closeModal();\n      \n      LoadingManager.show();\n      \n      try {\n        await API.deleteTask(taskId, this.currentUser.id);\n        this.showToast('Tarea eliminada', 'La tarea se ha eliminado correctamente', 'info');\n        \n        // Si estamos en el modal de edición, cerrarlo\n        if (fromModal) {\n          this.hideModal();\n        }\n        \n        await this.refresh();\n        await this.updateStats();\n      } catch (error) {\n        this.showToast('Error', 'No se pudo eliminar la tarea', 'error');\n      }\n      \n      LoadingManager.hide();\n    });\n    \n    // Cerrar al hacer clic fuera\n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) {\n        closeModal();\n      }\n    });\n  }\n\n  // MODIFICADO: Reemplazar prompt por modal\n  async deleteTask(taskId) {\n    // Obtener título de la tarea para mostrarlo en el modal\n    const tasks = await API.fetchTasks({}, this.currentUser.id);\n    const task = tasks.find(t => t.id === taskId);\n    \n    if (task) {\n      this.showDeleteConfirmation(taskId, task.title, false);\n    }\n  }\n\n  // Tag System\n  handleTagInput(e) {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      const value = e.target.value.trim();\n      if (value) {\n        this.addTagToTask(value);\n        e.target.value = '';\n        this.hideTagSuggestions();\n      }\n    }\n  }\n\n  showTagSuggestions(e) {\n    const value = e.target.value.trim();\n    const suggestions = document.getElementById('tagSuggestions');\n    \n    if (!value) {\n      this.hideTagSuggestions();\n      return;\n    }\n    \n    const matchingTags = this.tags.filter(tag => \n      tag.name.toLowerCase().includes(value.toLowerCase()) &&\n      !this.currentTaskTags.includes(tag.id)\n    );\n    \n    suggestions.innerHTML = '';\n    suggestions.classList.remove('hidden');\n    \n    // Existing tag suggestions\n    matchingTags.forEach(tag => {\n      const suggestion = document.createElement('div');\n      suggestion.className = 'tag-suggestion';\n      suggestion.innerHTML = `\n        <span class=\"tag-color-preview\" style=\"background-color: ${tag.color}; width: 12px; height: 12px; border-radius: 50%; display: inline-block; margin-right: 8px;\"></span>\n        ${tag.name}\n      `;\n      suggestion.onclick = () => {\n        this.addTagToTask(tag.id);\n        e.target.value = '';\n        this.hideTagSuggestions();\n      };\n      suggestions.appendChild(suggestion);\n    });\n    \n    // Create new tag option\n    const createSuggestion = document.createElement('div');\n    createSuggestion.className = 'tag-suggestion';\n    createSuggestion.innerHTML = `+ Crear \"${value}\"`;\n    createSuggestion.onclick = async () => {\n      try {\n        const newTag = await API.createTag({ name: value }, this.currentUser.id);\n        this.tags.push(newTag);\n        this.addTagToTask(newTag.id);\n        e.target.value = '';\n        this.hideTagSuggestions();\n        this.renderTagFilters();\n        this.showToast('Etiqueta creada', 'La etiqueta se ha creado y añadido a la tarea', 'success');\n      } catch (error) {\n        this.showToast('Error', error.message, 'error');\n      }\n    };\n    suggestions.appendChild(createSuggestion);\n  }\n\n  hideTagSuggestions() {\n    const suggestions = document.getElementById('tagSuggestions');\n    if (suggestions) {\n      suggestions.classList.add('hidden');\n    }\n  }\n\n  addTagToTask(tagIdentifier) {\n    if (typeof tagIdentifier === 'string') {\n      // Find existing tag\n      const existingTag = this.tags.find(t => t.name.toLowerCase() === tagIdentifier.toLowerCase());\n      if (existingTag) {\n        if (!this.currentTaskTags.includes(existingTag.id)) {\n          this.currentTaskTags.push(existingTag.id);\n        }\n      } else {\n        // Create new tag\n        API.createTag({ name: tagIdentifier }, this.currentUser.id)\n          .then(newTag => {\n            this.tags.push(newTag);\n            this.currentTaskTags.push(newTag.id);\n            this.renderTaskTags();\n            this.renderTagFilters();\n            this.showToast('Etiqueta creada', 'La etiqueta se ha creado y añadido a la tarea', 'success');\n          })\n          .catch(error => {\n            this.showToast('Error', error.message, 'error');\n          });\n        return;\n      }\n    } else {\n      // Add tag by ID\n      if (!this.currentTaskTags.includes(tagIdentifier)) {\n        this.currentTaskTags.push(tagIdentifier);\n      }\n    }\n    \n    this.renderTaskTags();\n  }\n\n  removeTagFromTask(tagId) {\n    this.currentTaskTags = this.currentTaskTags.filter(id => id !== tagId);\n    this.renderTaskTags();\n  }\n\n  renderTaskTags() {\n    const container = document.getElementById('tagsContainer');\n    if (!container) return;\n    \n    container.innerHTML = '';\n    \n    this.currentTaskTags.forEach(tagId => {\n      const tag = this.tags.find(t => t.id === tagId);\n      if (tag) {\n        const tagElement = document.createElement('span');\n        tagElement.className = 'tag';\n        tagElement.style.backgroundColor = tag.color;\n        tagElement.style.color = this.getContrastColor(tag.color);\n        tagElement.innerHTML = `\n          ${tag.name}\n          <button class=\"tag-remove\" onclick=\"app.removeTagFromTask('${tag.id}')\">\n            <i class=\"fas fa-times\"></i>\n          </button>\n        `;\n        container.appendChild(tagElement);\n      }\n    });\n  }\n\n  // Subtask System\n  addSubtask() {\n    const input = document.getElementById('subtaskInput');\n    if (!input) return;\n    \n    const title = input.value.trim();\n    \n    if (!title) return;\n    \n    this.currentTaskSubtasks.push({\n      id: Date.now() + Math.random().toString(36).substr(2, 9),\n      title,\n      completed: false,\n      createdAt: new Date().toISOString()\n    });\n    \n    input.value = '';\n    this.renderSubtasks();\n  }\n\n  removeSubtask(index) {\n    this.currentTaskSubtasks.splice(index, 1);\n    this.renderSubtasks();\n  }\n\n  toggleSubtask(index) {\n    if (this.currentTaskSubtasks[index]) {\n      this.currentTaskSubtasks[index].completed = !this.currentTaskSubtasks[index].completed;\n      this.renderSubtasks();\n    }\n  }\n\n  renderSubtasks() {\n    const container = document.getElementById('subtasksList');\n    if (!container) return;\n    \n    container.innerHTML = '';\n    \n    this.currentTaskSubtasks.forEach((subtask, index) => {\n      const subtaskItem = document.createElement('div');\n      subtaskItem.className = `subtask-item ${subtask.completed ? 'completed' : ''}`;\n      subtaskItem.innerHTML = `\n        <input type=\"checkbox\" class=\"subtask-checkbox\" ${subtask.completed ? 'checked' : ''} \n               onchange=\"app.toggleSubtask(${index})\">\n        <span class=\"subtask-text\">${subtask.title}</span>\n        <button class=\"btn-icon small\" onclick=\"app.removeSubtask(${index})\">\n          <i class=\"fas fa-times\"></i>\n        </button>\n      `;\n      container.appendChild(subtaskItem);\n    });\n  }\n\n  // Category Management\n  async renderCategorySidebar() {\n    const container = document.getElementById('categoryList');\n    if (!container) return;\n    \n    container.innerHTML = '';\n    \n    const tasks = await API.fetchTasks({}, this.currentUser.id);\n    \n    const categoriesWithCount = this.categories.map(category => {\n      const count = tasks.filter(t => t.category === category.id).length;\n      return { ...category, count };\n    });\n    \n    // Ordenar por cantidad de tareas (mayor a menor)\n    categoriesWithCount.sort((a, b) => b.count - a.count);\n    \n    categoriesWithCount.forEach(category => {\n      const categoryItem = document.createElement('div');\n      categoryItem.className = 'category-item';\n      categoryItem.dataset.categoryId = category.id;\n      categoryItem.innerHTML = `\n        <div style=\"display: flex; align-items: center; gap: 8px; min-width: 0;\">\n          <span class=\"category-color\" style=\"background-color: ${category.color}\"></span>\n          <span class=\"category-name\">${category.name}</span>\n        </div>\n        <span class=\"category-count\">${category.count}</span>\n      `;\n      \n      categoryItem.addEventListener('click', () => {\n        const filterCategory = document.getElementById('filterCategory');\n        if (filterCategory) {\n          filterCategory.value = category.id;\n          this.refresh();\n        }\n      });\n      \n      container.appendChild(categoryItem);\n    });\n    \n    // Actualizar también las fechas próximas\n    await this.renderUpcomingDates();\n  }\n\n  async renderUpcomingDates() {\n    const container = document.getElementById('upcomingDates');\n    if (!container) return;\n    \n    const tasks = await API.fetchTasks({}, this.currentUser.id);\n    \n    // Filtrar tareas con fecha límite en los próximos 7 días y que estén pendientes\n    const today = new Date();\n    const nextWeek = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);\n    \n    const upcomingTasks = tasks.filter(task => {\n      if (!task.dueDate || task.status === 'completed') return false;\n      \n      const dueDate = new Date(task.dueDate);\n      return dueDate >= today && dueDate <= nextWeek;\n    });\n    \n    // Agrupar por fecha\n    const tasksByDate = {};\n    upcomingTasks.forEach(task => {\n      if (!tasksByDate[task.dueDate]) {\n        tasksByDate[task.dueDate] = 0;\n      }\n      tasksByDate[task.dueDate]++;\n    });\n    \n    // Ordenar fechas\n    const sortedDates = Object.keys(tasksByDate).sort();\n    \n    container.innerHTML = '';\n    \n    if (sortedDates.length > 0) {\n      sortedDates.slice(0, 5).forEach(date => {\n        const dateItem = document.createElement('div');\n        dateItem.className = 'date-item';\n        \n        const formattedDate = new Date(date).toLocaleDateString('es-ES', {\n          weekday: 'short',\n          month: 'short',\n          day: 'numeric'\n        });\n        \n        dateItem.innerHTML = `\n          <span class=\"date\">${formattedDate}</span>\n          <span class=\"count\">${tasksByDate[date]}</span>\n        `;\n        \n        // Al hacer clic, filtrar por esa fecha\n        dateItem.addEventListener('click', () => {\n          document.getElementById('filterDate').value = date;\n          this.refresh();\n        });\n        \n        container.appendChild(dateItem);\n      });\n    } else {\n      container.innerHTML = '<p style=\"text-align: center; color: var(--text-light); font-size: 0.875rem; padding: 8px;\">No hay tareas próximas</p>';\n    }\n  }\n\n  renderCategoryFilters() {\n    const filterSelect = document.getElementById('filterCategory');\n    const taskFormSelect = document.getElementById('category');\n    \n    if (!filterSelect || !taskFormSelect) return;\n    \n    // Clear existing options (keep \"all\" and \"general\")\n    while (filterSelect.children.length > 2) filterSelect.removeChild(filterSelect.lastChild);\n    while (taskFormSelect.children.length > 1) taskFormSelect.removeChild(taskFormSelect.lastChild);\n    \n    this.categories.forEach(category => {\n      // Filter select\n      const filterOption = document.createElement('option');\n      filterOption.value = category.id;\n      filterOption.textContent = category.name;\n      filterSelect.appendChild(filterOption);\n      \n      // Task form select\n      const formOption = document.createElement('option');\n      formOption.value = category.id;\n      formOption.textContent = category.name;\n      taskFormSelect.appendChild(formOption);\n    });\n  }\n\n  async openCategoryModal() {\n    await this.renderCategoriesList();\n    document.getElementById('categoryModal').classList.remove('hidden');\n  }\n\n  async renderCategoriesList() {\n    const container = document.getElementById('categoriesList');\n    if (!container) return;\n    \n    container.innerHTML = '';\n    \n    const categoriesWithCount = await API.fetchCategoriesWithCount(this.currentUser.id);\n    \n    categoriesWithCount.forEach(category => {\n      const categoryItem = document.createElement('div');\n      categoryItem.className = 'category-item';\n      categoryItem.innerHTML = `\n        <div class=\"category-info\">\n          <span class=\"category-color\" style=\"background-color: ${category.color}\"></span>\n          <div>\n            <strong>${category.name}</strong>\n            <small>${category.count} tareas</small>\n          </div>\n        </div>\n        <div class=\"category-actions\">\n          <button class=\"btn-icon small\" onclick=\"app.editCategory('${category.id}')\">\n            <i class=\"fas fa-edit\"></i>\n          </button>\n          <button class=\"btn-icon small\" onclick=\"app.deleteCategory('${category.id}')\">\n            <i class=\"fas fa-trash\"></i>\n          </button>\n        </div>\n      `;\n      container.appendChild(categoryItem);\n    });\n  }\n\n  async addNewCategory() {\n    const nameInput = document.getElementById('categoryName');\n    const colorInput = document.getElementById('categoryColor');\n    \n    if (!nameInput || !colorInput) return;\n    \n    const name = nameInput.value.trim();\n    const color = colorInput.value;\n    \n    if (!name) {\n      this.showToast('Error', 'El nombre de la categoría es obligatorio', 'error');\n      return;\n    }\n    \n    try {\n      const newCategory = await API.createCategory({ name, color }, this.currentUser.id);\n      this.categories.push(newCategory);\n      await this.renderCategorySidebar();\n      this.renderCategoryFilters();\n      await this.renderCategoriesList();\n      nameInput.value = '';\n      this.showToast('Categoría creada', 'La categoría se ha creado correctamente', 'success');\n    } catch (error) {\n      this.showToast('Error', error.message, 'error');\n    }\n  }\n\n  // MODIFICADO: Reemplazar prompt por modal\n  async editCategory(categoryId) {\n    const category = this.categories.find(c => c.id === categoryId);\n    if (!category) return;\n    \n    // Crear modal para editar categoría\n    const modal = document.createElement('div');\n    modal.className = 'modal';\n    modal.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.5);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 2000;\n      backdrop-filter: blur(4px);\n      animation: fadeIn 0.2s ease;\n    `;\n    \n    modal.innerHTML = `\n      <div style=\"\n        background: var(--card-bg);\n        padding: 25px;\n        border-radius: var(--radius-lg);\n        width: 90%;\n        max-width: 350px;\n        box-shadow: var(--shadow-xl);\n        animation: slideUp 0.3s ease;\n      \">\n        <h3 style=\"margin-top: 0; margin-bottom: 20px; color: var(--text-primary);\">\n          <i class=\"fas fa-edit\"></i> Editar Categoría\n        </h3>\n        \n        <div style=\"display: flex; flex-direction: column; gap: 15px;\">\n          <div>\n            <label style=\"display: block; margin-bottom: 5px; color: var(--text-secondary);\">Nombre:</label>\n            <input type=\"text\" id=\"editCategoryNameInput\" value=\"${category.name}\" style=\"\n              width: 100%;\n              padding: 10px;\n              border: 2px solid var(--border-color);\n              border-radius: 8px;\n              background: var(--bg-color);\n              color: var(--text-primary);\n              font-size: 16px;\n            \" />\n          </div>\n          \n          <div>\n            <label style=\"display: block; margin-bottom: 5px; color: var(--text-secondary);\">Color:</label>\n            <input type=\"color\" id=\"editCategoryColorInput\" value=\"${category.color}\" style=\"\n              width: 100%;\n              height: 40px;\n              border: 2px solid var(--border-color);\n              border-radius: 8px;\n              cursor: pointer;\n            \" />\n          </div>\n          \n          <div style=\"display: flex; gap: 10px; margin-top: 10px;\">\n            <button id=\"cancelEditCategoryBtn\" style=\"\n              flex: 1;\n              padding: 10px;\n              background: var(--bg-color);\n              color: var(--text-secondary);\n              border: 2px solid var(--border-color);\n              border-radius: 6px;\n              cursor: pointer;\n              font-weight: 600;\n            \">Cancelar</button>\n            <button id=\"saveEditCategoryBtn\" style=\"\n              flex: 1;\n              padding: 10px;\n              background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);\n              color: white;\n              border: none;\n              border-radius: 6px;\n              cursor: pointer;\n              font-weight: bold;\n            \">Guardar</button>\n          </div>\n        </div>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Evento para cancelar\n    document.getElementById('cancelEditCategoryBtn').addEventListener('click', () => {\n      document.body.removeChild(modal);\n    });\n    \n    // Evento para guardar\n    document.getElementById('saveEditCategoryBtn').addEventListener('click', async () => {\n      const newName = document.getElementById('editCategoryNameInput').value.trim();\n      const newColor = document.getElementById('editCategoryColorInput').value;\n      \n      if (!newName) {\n        this.showToast('Error', 'El nombre de la categoría es obligatorio', 'error');\n        return;\n      }\n      \n      try {\n        await API.updateCategory(categoryId, { name: newName, color: newColor }, this.currentUser.id);\n        await this.loadCategories();\n        await this.refresh();\n        this.showToast('Categoría actualizada', 'La categoría se ha actualizado correctamente', 'success');\n        document.body.removeChild(modal);\n      } catch (error) {\n        this.showToast('Error', error.message, 'error');\n      }\n    });\n    \n    // Cerrar al hacer clic fuera\n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) {\n        document.body.removeChild(modal);\n      }\n    });\n  }\n\n  // MODIFICADO: Reemplazar prompt por modal\n  async deleteCategory(categoryId) {\n    const category = this.categories.find(c => c.id === categoryId);\n    if (!category) return;\n    \n    // Crear modal de confirmación\n    const modal = document.createElement('div');\n    modal.className = 'modal';\n    modal.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.5);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 2000;\n      backdrop-filter: blur(4px);\n      animation: fadeIn 0.2s ease;\n    `;\n    \n    modal.innerHTML = `\n      <div style=\"\n        background: var(--card-bg);\n        padding: 25px;\n        border-radius: var(--radius-lg);\n        width: 90%;\n        max-width: 400px;\n        box-shadow: var(--shadow-xl);\n        border: 2px solid var(--warning-color);\n        animation: slideUp 0.3s ease;\n      \">\n        <div style=\"text-align: center; margin-bottom: 20px;\">\n          <div style=\"font-size: 48px; color: var(--warning-color); margin-bottom: 15px;\">\n            <i class=\"fas fa-exclamation-triangle\"></i>\n          </div>\n          <h3 style=\"margin-bottom: 10px; color: var(--text-primary); font-size: 1.25rem;\">\n            ¿Eliminar categoría?\n          </h3>\n          <p style=\"color: var(--text-secondary); margin-bottom: 15px; line-height: 1.5;\">\n            Se eliminará la categoría: <strong>\"${category.name}\"</strong>.\n          </p>\n          <p style=\"color: var(--warning-color); font-size: 0.9rem; margin-bottom: 25px; padding: 10px; background: rgba(245, 158, 11, 0.1); border-radius: 8px;\">\n            <i class=\"fas fa-info-circle\"></i> Las tareas de esta categoría se moverán a \"General\".\n          </p>\n        </div>\n        \n        <div style=\"display: flex; gap: 10px;\">\n          <button id=\"cancelDeleteCategoryBtn\" style=\"\n            flex: 1;\n            padding: 12px 20px;\n            background: var(--bg-color);\n            color: var(--text-secondary);\n            border: 2px solid var(--border-color);\n            border-radius: var(--radius-md);\n            cursor: pointer;\n            font-weight: 600;\n            transition: all var(--transition-fast);\n          \">Cancelar</button>\n          <button id=\"confirmDeleteCategoryBtn\" style=\"\n            flex: 1;\n            padding: 12px 20px;\n            background: var(--warning-color);\n            color: white;\n            border: none;\n            border-radius: var(--radius-md);\n            cursor: pointer;\n            font-weight: 600;\n            transition: all var(--transition-fast);\n          \">Eliminar</button>\n        </div>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Eventos del modal\n    const cancelBtn = document.getElementById('cancelDeleteCategoryBtn');\n    const confirmBtn = document.getElementById('confirmDeleteCategoryBtn');\n    \n    const closeModal = () => {\n      document.body.removeChild(modal);\n    };\n    \n    cancelBtn.addEventListener('click', closeModal);\n    \n    confirmBtn.addEventListener('click', async () => {\n      closeModal();\n      \n      try {\n        await API.deleteCategory(categoryId, this.currentUser.id);\n        await this.loadCategories();\n        await this.refresh();\n        this.showToast('Categoría eliminada', 'La categoría se ha eliminado correctamente', 'info');\n      } catch (error) {\n        this.showToast('Error', error.message, 'error');\n      }\n    });\n    \n    // Cerrar al hacer clic fuera\n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) {\n        closeModal();\n      }\n    });\n  }\n\n  // Tag Management\n  renderTagFilters() {\n    let filterTags = document.getElementById('filterTags');\n    if (!filterTags) return;\n    \n    while (filterTags.children.length > 1) filterTags.removeChild(filterTags.lastChild);\n    \n    this.tags.forEach(tag => {\n      const option = document.createElement('option');\n      option.value = tag.id;\n      option.textContent = tag.name;\n      filterTags.appendChild(option);\n    });\n  }\n\n  async openTagsModal() {\n    await this.renderTagsList();\n    document.getElementById('tagsModal').classList.remove('hidden');\n  }\n\n  async renderTagsList() {\n    const container = document.getElementById('tagsList');\n    if (!container) return;\n    \n    container.innerHTML = '';\n    \n    this.tags.forEach(tag => {\n      const tagItem = document.createElement('div');\n      tagItem.className = 'tag-item';\n      tagItem.innerHTML = `\n        <div class=\"tag-info\">\n          <span class=\"tag-color\" style=\"background-color: ${tag.color}\"></span>\n          <span>${tag.name}</span>\n        </div>\n        <div class=\"tag-actions\">\n          <button class=\"btn-icon small\" onclick=\"app.editTag('${tag.id}')\">\n            <i class=\"fas fa-edit\"></i>\n          </button>\n          <button class=\"btn-icon small\" onclick=\"app.deleteTag('${tag.id}')\">\n            <i class=\"fas fa-trash\"></i>\n          </button>\n        </div>\n      `;\n      container.appendChild(tagItem);\n    });\n  }\n\n  async addNewTag() {\n    const nameInput = document.getElementById('newTagName');\n    const colorInput = document.getElementById('newTagColor');\n    \n    if (!nameInput || !colorInput) return;\n    \n    const name = nameInput.value.trim();\n    const color = colorInput.value;\n    \n    if (!name) {\n      this.showToast('Error', 'El nombre de la etiqueta es obligatorio', 'error');\n      return;\n    }\n    \n    try {\n      const newTag = await API.createTag({ name, color }, this.currentUser.id);\n      this.tags.push(newTag);\n      this.renderTagsList();\n      this.renderTagFilters();\n      nameInput.value = '';\n      this.showToast('Etiqueta creada', 'La etiqueta se ha creado correctamente', 'success');\n    } catch (error) {\n      this.showToast('Error', error.message, 'error');\n    }\n  }\n\n  // MODIFICADO: Ya usa modal (sin cambios)\n  async editTag(tagId) {\n    const tag = this.tags.find(t => t.id === tagId);\n    if (!tag) return;\n    \n    // Crear un mini modal para editar\n    const modal = document.createElement('div');\n    modal.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.5);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 1000;\n    `;\n    \n    modal.innerHTML = `\n      <div style=\"\n        background: var(--card-bg);\n        padding: 25px;\n        border-radius: 12px;\n        width: 90%;\n        max-width: 350px;\n        box-shadow: var(--shadow-xl);\n      \">\n        <h3 style=\"margin-top: 0; margin-bottom: 20px; color: var(--text-primary);\">\n          <i class=\"fas fa-edit\"></i> Editar Etiqueta\n        </h3>\n        \n        <div style=\"display: flex; flex-direction: column; gap: 15px;\">\n          <div>\n            <label style=\"display: block; margin-bottom: 5px; color: var(--text-secondary);\">Nombre:</label>\n            <input type=\"text\" id=\"editTagNameInput\" value=\"${tag.name}\" style=\"\n              width: 100%;\n              padding: 10px;\n              border: 2px solid var(--border-color);\n              border-radius: 8px;\n              background: var(--bg-color);\n              color: var(--text-primary);\n              font-size: 16px;\n            \" />\n          </div>\n          \n          <div>\n            <label style=\"display: block; margin-bottom: 5px; color: var(--text-secondary);\">Color:</label>\n            <input type=\"color\" id=\"editTagColorInput\" value=\"${tag.color}\" style=\"\n              width: 100%;\n              height: 40px;\n              border: 2px solid var(--border-color);\n              border-radius: 8px;\n              cursor: pointer;\n            \" />\n          </div>\n          \n          <div style=\"display: flex; gap: 10px; margin-top: 10px;\">\n            <button id=\"cancelEditTagBtn\" style=\"\n              flex: 1;\n              padding: 10px;\n              background: var(--bg-color);\n              color: var(--text-secondary);\n              border: 2px solid var(--border-color);\n              border-radius: 6px;\n              cursor: pointer;\n              font-weight: 600;\n            \">Cancelar</button>\n            <button id=\"saveEditTagBtn\" style=\"\n              flex: 1;\n              padding: 10px;\n              background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);\n              color: white;\n              border: none;\n              border-radius: 6px;\n              cursor: pointer;\n              font-weight: bold;\n            \">Guardar</button>\n          </div>\n        </div>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Evento para cancelar\n    document.getElementById('cancelEditTagBtn').addEventListener('click', () => {\n      document.body.removeChild(modal);\n    });\n    \n    // Evento para guardar\n    document.getElementById('saveEditTagBtn').addEventListener('click', async () => {\n      const newName = document.getElementById('editTagNameInput').value.trim();\n      const newColor = document.getElementById('editTagColorInput').value;\n      \n      if (!newName) {\n        this.showToast('Error', 'El nombre de la etiqueta es obligatorio', 'error');\n        return;\n      }\n      \n      try {\n        await API.updateTag(tagId, { name: newName, color: newColor }, this.currentUser.id);\n        await this.loadTags();\n        await this.renderTagsList();\n        this.renderTagFilters();\n        this.showToast('Etiqueta actualizada', 'La etiqueta se ha actualizado correctamente', 'success');\n        document.body.removeChild(modal);\n      } catch (error) {\n        this.showToast('Error', error.message, 'error');\n      }\n    });\n    \n    // Cerrar al hacer clic fuera\n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) {\n        document.body.removeChild(modal);\n      }\n    });\n  }\n\n  // MODIFICADO: Reemplazar prompt por modal\n  async deleteTag(tagId) {\n    const tag = this.tags.find(t => t.id === tagId);\n    if (!tag) return;\n    \n    // Crear modal de confirmación\n    const modal = document.createElement('div');\n    modal.className = 'modal';\n    modal.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.5);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 2000;\n      backdrop-filter: blur(4px);\n      animation: fadeIn 0.2s ease;\n    `;\n    \n    modal.innerHTML = `\n      <div style=\"\n        background: var(--card-bg);\n        padding: 25px;\n        border-radius: var(--radius-lg);\n        width: 90%;\n        max-width: 400px;\n        box-shadow: var(--shadow-xl);\n        border: 2px solid var(--warning-color);\n        animation: slideUp 0.3s ease;\n      \">\n        <div style=\"text-align: center; margin-bottom: 20px;\">\n          <div style=\"font-size: 48px; color: var(--warning-color); margin-bottom: 15px;\">\n            <i class=\"fas fa-exclamation-triangle\"></i>\n          </div>\n          <h3 style=\"margin-bottom: 10px; color: var(--text-primary); font-size: 1.25rem;\">\n            ¿Eliminar etiqueta?\n          </h3>\n          <p style=\"color: var(--text-secondary); margin-bottom: 15px; line-height: 1.5;\">\n            Se eliminará la etiqueta: <strong>\"${tag.name}\"</strong>.\n          </p>\n          <p style=\"color: var(--warning-color); font-size: 0.9rem; margin-bottom: 25px; padding: 10px; background: rgba(245, 158, 11, 0.1); border-radius: 8px;\">\n            <i class=\"fas fa-info-circle\"></i> La etiqueta se eliminará de todas las tareas.\n          </p>\n        </div>\n        \n        <div style=\"display: flex; gap: 10px;\">\n          <button id=\"cancelDeleteTagBtn\" style=\"\n            flex: 1;\n            padding: 12px 20px;\n            background: var(--bg-color);\n            color: var(--text-secondary);\n            border: 2px solid var(--border-color);\n            border-radius: var(--radius-md);\n            cursor: pointer;\n            font-weight: 600;\n            transition: all var(--transition-fast);\n          \">Cancelar</button>\n          <button id=\"confirmDeleteTagBtn\" style=\"\n            flex: 1;\n            padding: 12px 20px;\n            background: var(--warning-color);\n            color: white;\n            border: none;\n            border-radius: var(--radius-md);\n            cursor: pointer;\n            font-weight: 600;\n            transition: all var(--transition-fast);\n          \">Eliminar</button>\n        </div>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Eventos del modal\n    const cancelBtn = document.getElementById('cancelDeleteTagBtn');\n    const confirmBtn = document.getElementById('confirmDeleteTagBtn');\n    \n    const closeModal = () => {\n      document.body.removeChild(modal);\n    };\n    \n    cancelBtn.addEventListener('click', closeModal);\n    \n    confirmBtn.addEventListener('click', async () => {\n      closeModal();\n      \n      try {\n        await API.deleteTag(tagId, this.currentUser.id);\n        this.tags = this.tags.filter(t => t.id !== tagId);\n        this.renderTagsList();\n        this.renderTagFilters();\n        this.showToast('Etiqueta eliminada', 'La etiqueta se ha eliminado correctamente', 'info');\n      } catch (error) {\n        this.showToast('Error', error.message, 'error');\n      }\n    });\n    \n    // Cerrar al hacer clic fuera\n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) {\n        closeModal();\n      }\n    });\n  }\n\n  // Color Settings\n  async openColorSettings() {\n    const modal = document.getElementById('colorSettingsModal');\n    if (!modal) return;\n    \n    // Fill with current values\n    document.getElementById('primaryColor').value = this.colorSettings.primaryColor;\n    document.getElementById('secondaryColor').value = this.colorSettings.secondaryColor;\n    document.getElementById('cardBgColor').value = this.colorSettings.cardBg;\n    document.getElementById('appBgColor').value = this.colorSettings.appBg;\n    \n    // Update color values display\n    document.getElementById('primaryValue').textContent = this.colorSettings.primaryColor;\n    document.getElementById('secondaryValue').textContent = this.colorSettings.secondaryColor;\n    document.getElementById('cardBgValue').textContent = this.colorSettings.cardBg;\n    document.getElementById('appBgValue').textContent = this.colorSettings.appBg;\n    \n    modal.classList.remove('hidden');\n  }\n\n  previewColorChange(id, value) {\n    // Update the color value display\n    const valueElement = document.getElementById(id + 'Value');\n    if (valueElement) {\n      valueElement.textContent = value;\n    }\n    \n    // Create a preview settings object\n    const previewSettings = new ColorSettings({\n      ...this.colorSettings,\n      [this.mapInputIdToProperty(id)]: value\n    });\n    \n    // Apply preview\n    ColorService.applyTheme(previewSettings);\n  }\n\n  mapInputIdToProperty(id) {\n    const map = {\n      'primaryColor': 'primaryColor',\n      'secondaryColor': 'secondaryColor',\n      'cardBgColor': 'cardBg',\n      'appBgColor': 'appBg'\n    };\n    return map[id] || id;\n  }\n\n  async saveColorSettings() {\n    const primaryColor = document.getElementById('primaryColor').value;\n    const secondaryColor = document.getElementById('secondaryColor').value;\n    const cardBg = document.getElementById('cardBgColor').value;\n    const appBg = document.getElementById('appBgColor').value;\n    \n    const settings = new ColorSettings({\n      userId: this.currentUser.id,\n      theme: this.colorSettings.theme,\n      primaryColor: primaryColor,\n      secondaryColor: secondaryColor,\n      cardBg: cardBg,\n      textColor: this.colorSettings.textColor,\n      borderColor: this.colorSettings.borderColor,\n      appBg: appBg,\n      accentColor: this.colorSettings.accentColor\n    });\n\n    await API.saveColorSettings(this.currentUser.id, settings);\n    this.colorSettings = settings;\n    document.getElementById('colorSettingsModal').classList.add('hidden');\n    this.showToast('Tema guardado', 'Los cambios se han guardado correctamente', 'success');\n  }\n\n  async resetColors() {\n    const defaultSettings = new ColorSettings({ userId: this.currentUser.id });\n    await API.saveColorSettings(this.currentUser.id, defaultSettings);\n    this.colorSettings = defaultSettings;\n    ColorService.applyTheme(defaultSettings);\n    this.openColorSettings();\n    this.showToast('Tema restaurado', 'Se ha restaurado el tema predeterminado', 'info');\n  }\n\n  applyColorPreset(presetName) {\n    const preset = ColorService.getPreset(presetName);\n    \n    // Update inputs\n    document.getElementById('primaryColor').value = preset.primaryColor;\n    document.getElementById('secondaryColor').value = preset.secondaryColor;\n    document.getElementById('cardBgColor').value = preset.cardBg;\n    document.getElementById('appBgColor').value = preset.appBg;\n    \n    // Update displays\n    document.getElementById('primaryValue').textContent = preset.primaryColor;\n    document.getElementById('secondaryValue').textContent = preset.secondaryColor;\n    document.getElementById('cardBgValue').textContent = preset.cardBg;\n    document.getElementById('appBgValue').textContent = preset.appBg;\n    \n    // Apply preview\n    const previewSettings = new ColorSettings({\n      ...preset,\n      userId: this.currentUser.id\n    });\n    ColorService.applyTheme(previewSettings);\n  }\n\n  toggleTheme() {\n    const newTheme = this.colorSettings.theme === 'light' ? 'dark' : 'light';\n    this.colorSettings.theme = newTheme;\n    \n    // Update icon\n    const icon = document.querySelector('#themeToggle i');\n    if (icon) {\n      icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';\n    }\n    \n    ColorService.applyTheme(this.colorSettings);\n    API.saveColorSettings(this.currentUser.id, this.colorSettings);\n  }\n\n  // Notifications\n  async toggleNotifications() {\n    const center = document.getElementById('notificationCenter');\n    if (!center) return;\n    \n    center.classList.toggle('hidden');\n    \n    if (!center.classList.contains('hidden')) {\n      await API.markAllNotificationsAsRead(this.currentUser.id);\n      await this.loadNotifications();\n    }\n  }\n\n  renderNotifications() {\n    const container = document.getElementById('notificationsList');\n    if (!container) return;\n    \n    container.innerHTML = '';\n    \n    this.notifications.forEach(notification => {\n      const notificationItem = document.createElement('div');\n      notificationItem.className = `notification-item ${notification.read ? '' : 'unread'}`;\n      notificationItem.innerHTML = `\n        <div class=\"notification-title\">${notification.title}</div>\n        <div class=\"notification-message\">${notification.message}</div>\n        <div class=\"notification-time\">${this.formatTimeAgo(notification.createdAt)}</div>\n      `;\n      \n      if (notification.taskId) {\n        notificationItem.style.cursor = 'pointer';\n        notificationItem.addEventListener('click', async () => {\n          // Find and open the task\n          const tasks = await API.fetchTasks({}, this.currentUser.id);\n          const task = tasks.find(t => t.id === notification.taskId);\n          if (task) {\n            this.openTaskDetail(task);\n            document.getElementById('notificationCenter').classList.add('hidden');\n          }\n        });\n      }\n      \n      container.appendChild(notificationItem);\n    });\n  }\n\n  // Task List and Filters\n  async refresh() {\n    LoadingManager.show();\n    \n    const taskList = document.getElementById('taskList');\n    const emptyState = document.getElementById('emptyState');\n    const filters = this.getFilters();\n\n    // Obtener preferencia de ordenamiento\n    const sortPref = JSON.parse(localStorage.getItem('taskflow_sort_preference') || '{\"field\":\"createdAt\",\"direction\":\"desc\"}');\n    filters.sortBy = sortPref.field;\n    filters.sortDirection = sortPref.direction;\n    \n    const tasks = await API.fetchTasks(filters, this.currentUser.id);\n    \n    if (tasks.length === 0) {\n      if (taskList) taskList.classList.add('hidden');\n      if (emptyState) emptyState.classList.remove('hidden');\n    } else {\n      if (taskList) taskList.classList.remove('hidden');\n      if (emptyState) emptyState.classList.add('hidden');\n      \n      if (taskList) {\n        taskList.innerHTML = '';\n        \n        if (this.viewMode === 'grid') {\n          taskList.className = 'task-grid';\n          tasks.forEach(task => {\n            const card = this.createTaskCard(task);\n            taskList.appendChild(card);\n          });\n        } else {\n          taskList.className = 'task-list-view';\n          tasks.forEach(task => {\n            const row = this.createTaskRow(task);\n            taskList.appendChild(row);\n          });\n        }\n      }\n    }\n    \n    // Update tasks title\n    const tasksTitle = document.getElementById('tasksTitle');\n    if (tasksTitle) {\n      const totalTasks = tasks.length;\n      tasksTitle.textContent = `Mis Tareas ${totalTasks > 0 ? `(${totalTasks})` : ''}`;\n    }\n    \n    // Actualizar sidebar de categorías\n    await this.renderCategorySidebar();\n    \n    LoadingManager.hide();\n  }\n\n  getFilters() {\n    const filterTags = document.getElementById('filterTags');\n    const sortPref = JSON.parse(localStorage.getItem('taskflow_sort_preference') || '{\"field\":\"createdAt\",\"direction\":\"desc\"}');\n    \n    return {\n      status: document.getElementById('filterStatus')?.value || 'all',\n      priority: document.getElementById('filterPriority')?.value || 'all',\n      category: document.getElementById('filterCategory')?.value || 'all',\n      tag: filterTags ? filterTags.value : 'all',\n      dueDate: document.getElementById('filterDate')?.value || '',\n      search: document.getElementById('search')?.value.trim() || '',\n      sortBy: sortPref.field || 'createdAt',\n      sortDirection: sortPref.direction || 'desc'\n    };\n  }\n\n  clearFilters() {\n    document.getElementById('filterStatus').value = 'all';\n    document.getElementById('filterPriority').value = 'all';\n    document.getElementById('filterCategory').value = 'all';\n    document.getElementById('filterTags').value = 'all';\n    document.getElementById('filterDate').value = '';\n    document.getElementById('search').value = '';\n    \n    this.refresh();\n  }\n\n  setViewMode(mode) {\n    this.viewMode = mode;\n    \n    // Update button states\n    const viewGrid = document.getElementById('viewGrid');\n    const viewList = document.getElementById('viewList');\n    \n    if (viewGrid) viewGrid.classList.toggle('active', mode === 'grid');\n    if (viewList) viewList.classList.toggle('active', mode === 'list');\n    \n    this.refresh();\n  }\n\n  showSortOptions() {\n    const modal = document.createElement('div');\n    modal.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.5);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 1000;\n    `;\n    \n    modal.innerHTML = `\n      <div style=\"\n        background: var(--card-bg);\n        padding: 25px;\n        border-radius: 12px;\n        width: 90%;\n        max-width: 350px;\n        box-shadow: var(--shadow-xl);\n      \">\n        <h3 style=\"margin-top: 0; margin-bottom: 20px; color: var(--text-primary);\">\n          <i class=\"fas fa-sort\"></i> Ordenar por:\n        </h3>\n        \n        <form id=\"sort-form-modal\" style=\"display: flex; flex-direction: column; gap: 10px;\">\n          <label style=\"display: flex; align-items: center; gap: 10px; padding: 10px; border-radius: 8px; background: var(--bg-color); cursor: pointer;\">\n            <input type=\"radio\" name=\"sort\" value=\"createdAt\" checked>\n            <span>Fecha de creación (nuevas primero)</span>\n          </label>\n          \n          <label style=\"display: flex; align-items: center; gap: 10px; padding: 10px; border-radius: 8px; background: var(--bg-color); cursor: pointer;\">\n            <input type=\"radio\" name=\"sort\" value=\"dueDate\">\n            <span>Fecha límite</span>\n          </label>\n          \n          <label style=\"display: flex; align-items: center; gap: 10px; padding: 10px; border-radius: 8px; background: var(--bg-color); cursor: pointer;\">\n            <input type=\"radio\" name=\"sort\" value=\"priority\">\n            <span>Prioridad</span>\n          </label>\n          \n          <div style=\"margin: 15px 0; padding: 15px 0; border-top: 1px solid var(--border-color); border-bottom: 1px solid var(--border-color);\">\n            <label style=\"display: flex; align-items: center; gap: 10px;\">\n              <input type=\"radio\" name=\"direction\" value=\"desc\" checked>\n              <span>Descendente (nuevas/urgentes primero)</span>\n            </label>\n            <label style=\"display: flex; align-items: center; gap: 10px;\">\n              <input type=\"radio\" name=\"direction\" value=\"asc\">\n              <span>Ascendente (antiguas/lejanas primero)</span>\n            </label>\n          </div>\n          \n          <div style=\"display: flex; gap: 10px; margin-top: 10px;\">\n            <button type=\"button\" id=\"cancelSortBtn\" style=\"\n              flex: 1;\n              padding: 10px;\n              background: var(--bg-color);\n              color: var(--text-secondary);\n              border: 2px solid var(--border-color);\n              border-radius: 6px;\n              cursor: pointer;\n              font-weight: 600;\n            \">Cancelar</button>\n            <button type=\"submit\" style=\"\n              flex: 1;\n              padding: 10px;\n              background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);\n              color: white;\n              border: none;\n              border-radius: 6px;\n              cursor: pointer;\n              font-weight: bold;\n              box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);\n            \">Aplicar</button>\n          </div>\n        </form>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Eventos de cierre\n    document.getElementById('cancelSortBtn').addEventListener('click', () => {\n      document.body.removeChild(modal);\n    });\n    \n    modal.addEventListener('click', (e) => {\n      if (e.target === modal) {\n        document.body.removeChild(modal);\n      }\n    });\n    \n    // Evento de envío\n    document.getElementById('sort-form-modal').addEventListener('submit', (e) => {\n      e.preventDefault();\n      const sortBy = modal.querySelector('input[name=\"sort\"]:checked').value;\n      const direction = modal.querySelector('input[name=\"direction\"]:checked').value;\n      \n      const sortMessage = `Ordenando por ${sortBy === 'createdAt' ? 'fecha de creación' : sortBy === 'dueDate' ? 'fecha límite' : 'prioridad'} (${direction === 'desc' ? 'descendente' : 'ascendente'})`;\n      \n      this.showToast('Ordenamiento', sortMessage, 'info');\n      \n      // Guardar preferencia\n      localStorage.setItem('taskflow_sort_preference', JSON.stringify({ \n        field: sortBy, \n        direction: direction \n      }));\n      \n      // Recargar tareas\n      this.refresh();\n      \n      document.body.removeChild(modal);\n    });\n  }\n\n  createTaskCard(task) {\n    const card = document.createElement('div');\n    card.className = `task-card priority-${task.priority} ${task.status === 'completed' ? 'completed' : ''}`;\n    \n    // Get category color\n    const category = this.categories.find(c => c.id === task.category);\n    const categoryColor = category ? category.color : '#64748b';\n    \n    // Priority indicator\n    card.style.borderLeftColor = this.getPriorityColor(task.priority);\n    \n    // Añadir gradiente sutil basado en prioridad\n    if (task.priority === 'high') {\n      card.style.background = 'linear-gradient(to right, rgba(239, 68, 68, 0.05), var(--card-bg))';\n    } else if (task.priority === 'medium') {\n      card.style.background = 'linear-gradient(to right, rgba(245, 158, 11, 0.05), var(--card-bg))';\n    } else if (task.priority === 'low') {\n      card.style.background = 'linear-gradient(to right, rgba(16, 185, 129, 0.05), var(--card-bg))';\n    }\n    \n    // Task tags\n    const taskTags = task.tags ? task.tags.map(tagId => {\n      const tag = this.tags.find(t => t.id === tagId);\n      return tag ? `<span class=\"task-tag\" style=\"background-color: ${tag.color}; color: ${this.getContrastColor(tag.color)}\">${tag.name}</span>` : '';\n    }).join('') : '';\n    \n    // Due date indicator\n    const dueDateInfo = task.dueDate ? this.getDueDateInfo(task.dueDate) : '';\n    \n    // Progress indicator for subtasks\n    const progressIndicator = task.subtasks && task.subtasks.length > 0 ? \n      `<div class=\"progress-indicator\">\n        <div class=\"progress-fill\" style=\"width: ${task.getCompletionPercentage()}%\"></div>\n      </div>` : '';\n    \n    const taskData = JSON.stringify(task).replace(/\"/g, '&quot;');\n    \n    card.innerHTML = `\n      <div class=\"task-header\">\n        <div class=\"task-title\">${this.escapeHtml(task.title)}</div>\n        <div class=\"task-actions\">\n          <button class=\"btn-icon small\" onclick=\"app.toggleTaskStatus('${task.id}')\">\n            <i class=\"fas ${task.status === 'completed' ? 'fa-undo' : 'fa-check'}\"></i>\n          </button>\n          <button class=\"btn-icon small\" onclick=\"app.openEditTask(${taskData})\">\n            <i class=\"fas fa-edit\"></i>\n          </button>\n        </div>\n      </div>\n      <div class=\"task-description\">${this.escapeHtml(task.description || 'Sin descripción')}</div>\n      ${taskTags ? `<div class=\"task-tags\">${taskTags}</div>` : ''}\n      ${progressIndicator}\n      <div class=\"task-meta\">\n        <div class=\"task-info\">\n          <span title=\"Categoría\"><i class=\"fas fa-folder\" style=\"color: ${categoryColor}\"></i> ${category ? category.name : 'General'}</span>\n          <span title=\"Fecha límite\"><i class=\"fas fa-calendar\"></i> ${task.dueDate ? new Date(task.dueDate).toLocaleDateString() : 'Sin fecha'}</span>\n          ${dueDateInfo}\n        </div>\n        <div class=\"task-status\">\n          <span class=\"status-badge ${task.status}\">${task.status === 'completed' ? '✅ Completada' : '⏳ Pendiente'}</span>\n        </div>\n      </div>\n    `;\n    \n    card.addEventListener('click', (e) => {\n      if (!e.target.closest('.btn-icon')) {\n        this.openTaskDetail(task);\n      }\n    });\n    \n    return card;\n  }\n\n  createTaskRow(task) {\n    const row = document.createElement('div');\n    row.className = `task-row priority-${task.priority} ${task.status === 'completed' ? 'completed' : ''}`;\n    \n    // Get category color\n    const category = this.categories.find(c => c.id === task.category);\n    const categoryColor = category ? category.color : '#64748b';\n    \n    const taskData = JSON.stringify(task).replace(/\"/g, '&quot;');\n    \n    row.innerHTML = `\n      <div class=\"row-checkbox\">\n        <input type=\"checkbox\" ${task.status === 'completed' ? 'checked' : ''} \n               onchange=\"app.toggleTaskStatus('${task.id}')\">\n      </div>\n      <div class=\"row-title\">\n        <span class=\"task-title-text\">${this.escapeHtml(task.title)}</span>\n        ${task.description ? `<small class=\"row-description\">${this.escapeHtml(task.description)}</small>` : ''}\n      </div>\n      <div class=\"row-category\">\n        <span class=\"category-dot\" style=\"background-color: ${categoryColor}\"></span>\n        ${category ? category.name : 'General'}\n      </div>\n      <div class=\"row-date\">${task.dueDate ? new Date(task.dueDate).toLocaleDateString() : '—'}</div>\n      <div class=\"row-priority priority-${task.priority}\">${this.getPriorityText(task.priority)}</div>\n      <div class=\"row-actions\">\n        <button class=\"btn-icon small\" onclick=\"app.openTaskDetail(${taskData})\">\n          <i class=\"fas fa-eye\"></i>\n        </button>\n        <button class=\"btn-icon small\" onclick=\"app.openEditTask(${taskData})\">\n          <i class=\"fas fa-edit\"></i>\n        </button>\n        <button class=\"btn-icon small\" onclick=\"app.deleteTask('${task.id}')\">\n          <i class=\"fas fa-trash\"></i>\n        </button>\n      </div>\n    `;\n    \n    return row;\n  }\n\n  // Task Detail View\n  async openTaskDetail(task) {\n    // Load fresh task data\n    const tasks = await API.fetchTasks({}, this.currentUser.id);\n    const freshTask = tasks.find(t => t.id === task.id);\n    if (!freshTask) return;\n    \n    // Fill detail modal\n    document.getElementById('detailTitle').textContent = freshTask.title;\n    document.getElementById('detailStatus').textContent = freshTask.status === 'completed' ? 'Completada' : 'Pendiente';\n    document.getElementById('detailStatus').className = `detail-badge ${freshTask.status === 'completed' ? 'success' : 'warning'}`;\n    document.getElementById('detailPriority').textContent = this.getPriorityText(freshTask.priority);\n    document.getElementById('detailPriority').className = `detail-badge priority-${freshTask.priority}`;\n    \n    const category = this.categories.find(c => c.id === freshTask.category);\n    document.getElementById('detailCategory').textContent = category ? category.name : 'General';\n    document.getElementById('detailCategory').className = 'detail-badge';\n    document.getElementById('detailCategory').style.backgroundColor = category ? category.color : '#64748b';\n    document.getElementById('detailCategory').style.color = category ? this.getContrastColor(category.color) : 'white';\n    \n    document.getElementById('detailDueDate').textContent = freshTask.dueDate ? \n      new Date(freshTask.dueDate).toLocaleDateString() : 'No especificada';\n    document.getElementById('detailCreatedAt').textContent = new Date(freshTask.createdAt).toLocaleDateString();\n    document.getElementById('detailUpdatedAt').textContent = new Date(freshTask.updatedAt).toLocaleDateString();\n    document.getElementById('detailDescription').textContent = freshTask.description || 'No hay descripción';\n    \n    // Tags\n    const tagsContainer = document.getElementById('detailTags');\n    if (tagsContainer) {\n      tagsContainer.innerHTML = '';\n      \n      if (freshTask.tags && freshTask.tags.length > 0) {\n        freshTask.tags.forEach(tagId => {\n          const tag = this.tags.find(t => t.id === tagId);\n          if (tag) {\n            const tagElement = document.createElement('span');\n            tagElement.className = 'tag';\n            tagElement.style.backgroundColor = tag.color;\n            tagElement.style.color = this.getContrastColor(tag.color);\n            tagElement.textContent = tag.name;\n            tagsContainer.appendChild(tagElement);\n          }\n        });\n        document.getElementById('detailTagsSection').classList.remove('hidden');\n      } else {\n        document.getElementById('detailTagsSection').classList.add('hidden');\n      }\n    }\n    \n    // Subtasks\n    const subtasksContainer = document.getElementById('detailSubtasks');\n    if (subtasksContainer) {\n      subtasksContainer.innerHTML = '';\n      \n      if (freshTask.subtasks && freshTask.subtasks.length > 0) {\n        freshTask.subtasks.forEach((subtask, index) => {\n          const subtaskElement = document.createElement('div');\n          subtaskElement.className = `detail-subtask ${subtask.completed ? 'completed' : ''}`;\n          subtaskElement.innerHTML = `\n            <input type=\"checkbox\" ${subtask.completed ? 'checked' : ''} \n                   onchange=\"app.toggleTaskSubtask('${freshTask.id}', ${index})\">\n            <span>${subtask.title}</span>\n          `;\n          subtasksContainer.appendChild(subtaskElement);\n        });\n        document.getElementById('detailSubtasksSection').classList.remove('hidden');\n      } else {\n        document.getElementById('detailSubtasksSection').classList.add('hidden');\n      }\n    }\n    \n    // Action buttons\n    const toggleBtn = document.getElementById('detailToggleBtn');\n    if (toggleBtn) {\n      toggleBtn.innerHTML = freshTask.status === 'completed' ? \n        '<i class=\"fas fa-undo\"></i> Marcar como Pendiente' : \n        '<i class=\"fas fa-check-circle\"></i> Marcar como Completada';\n      toggleBtn.onclick = async () => {\n        await this.toggleTaskStatus(freshTask.id);\n        this.closeTaskDetail();\n      };\n    }\n    \n    const editBtn = document.getElementById('detailEditBtn');\n    if (editBtn) {\n      editBtn.onclick = () => {\n        this.closeTaskDetail();\n        this.openEditTask(freshTask);\n      };\n    }\n    \n    const deleteBtn = document.getElementById('detailDeleteBtn');\n    if (deleteBtn) {\n      // MODIFICADO: Reemplazar confirm por modal\n      deleteBtn.onclick = () => {\n        this.closeTaskDetail();\n        this.showDeleteConfirmation(freshTask.id, freshTask.title, false);\n      };\n    }\n    \n    // Show modal\n    document.getElementById('taskDetailModal').classList.remove('hidden');\n  }\n\n  closeTaskDetail() {\n    document.getElementById('taskDetailModal').classList.add('hidden');\n  }\n\n  // Task Actions\n  async toggleTaskStatus(taskId) {\n    LoadingManager.show();\n    \n    try {\n      const tasks = await API.fetchTasks({}, this.currentUser.id);\n      const task = tasks.find(t => t.id === taskId);\n      if (!task) return;\n      \n      const newStatus = task.status === 'pending' ? 'completed' : 'pending';\n      await API.updateTask(taskId, { status: newStatus }, this.currentUser.id);\n      \n      await this.refresh();\n      await this.updateStats();\n      \n      this.showToast(\n        'Estado actualizado',\n        `Tarea marcada como ${newStatus === 'completed' ? 'completada' : 'pendiente'}`,\n        'success'\n      );\n    } catch (error) {\n      this.showToast('Error', 'No se pudo actualizar el estado', 'error');\n    }\n    \n    LoadingManager.hide();\n  }\n\n  async toggleTaskSubtask(taskId, subtaskIndex) {\n    try {\n      await API.toggleSubtask(taskId, subtaskIndex, this.currentUser.id);\n      // Refresh the detail view if open\n      if (!document.getElementById('taskDetailModal').classList.contains('hidden')) {\n        const tasks = await API.fetchTasks({}, this.currentUser.id);\n        const task = tasks.find(t => t.id === taskId);\n        if (task) {\n          this.openTaskDetail(task);\n        }\n      }\n    } catch (error) {\n      this.showToast('Error', 'No se pudo actualizar la subtarea', 'error');\n    }\n  }\n\n  // MODIFICADO: Esta función ahora usa el modal (ver deleteTask arriba)\n\n  // Export\n  async exportTasks() {\n    try {\n      const format = confirm('¿Exportar como JSON? (Cancelar para CSV)') ? 'json' : 'csv';\n      const url = await API.exportTasks(format, this.currentUser.id);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `taskflow_export_${new Date().toISOString().split('T')[0]}.${format}`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n      \n      this.showToast('Exportación exitosa', `Datos exportados como ${format.toUpperCase()}`, 'success');\n    } catch (error) {\n      this.showToast('Error de exportación', 'No se pudieron exportar los datos', 'error');\n    }\n  }\n\n  // Utility Functions\n  getPriorityColor(priority) {\n    const colors = {\n      high: '#ef4444',\n      medium: '#f59e0b',\n      low: '#10b981'\n    };\n    return colors[priority] || '#64748b';\n  }\n\n  getPriorityText(priority) {\n    const texts = {\n      high: 'Alta',\n      medium: 'Media',\n      low: 'Baja'\n    };\n    return texts[priority] || priority;\n  }\n\n  getDueDateInfo(dueDate) {\n    const today = new Date().toISOString().split('T')[0];\n    const tomorrow = new Date(Date.now() + 86400000).toISOString().split('T')[0];\n    \n    if (dueDate === today) {\n      return '<span title=\"Vence hoy\" style=\"color: #ef4444;\"><i class=\"fas fa-exclamation-circle\"></i> Hoy</span>';\n    } else if (dueDate === tomorrow) {\n      return '<span title=\"Vence mañana\" style=\"color: #f59e0b;\"><i class=\"fas fa-clock\"></i> Mañana</span>';\n    } else if (dueDate < today) {\n      return '<span title=\"Vencida\" style=\"color: #dc2626;\"><i class=\"fas fa-exclamation-triangle\"></i> Vencida</span>';\n    }\n    return '';\n  }\n\n  getContrastColor(hexcolor) {\n    hexcolor = hexcolor.replace(\"#\", \"\");\n    const r = parseInt(hexcolor.substr(0, 2), 16);\n    const g = parseInt(hexcolor.substr(2, 2), 16);\n    const b = parseInt(hexcolor.substr(4, 2), 16);\n    const yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000;\n    return (yiq >= 128) ? '#000000' : '#ffffff';\n  }\n\n  formatTimeAgo(dateString) {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffMs = now - date;\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n    \n    if (diffMins < 1) return 'ahora';\n    if (diffMins < 60) return `hace ${diffMins} min`;\n    if (diffHours < 24) return `hace ${diffHours} h`;\n    if (diffDays < 7) return `hace ${diffDays} d`;\n    return date.toLocaleDateString();\n  }\n\n  escapeHtml(text) {\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n  }\n\n  // Toast notifications\n  showToast(title, message, type = 'info') {\n    return ToastManager.show(title, message, type, 3000);\n  }\n}\n\n// Initialize the app when DOM is ready\ndocument.addEventListener('DOMContentLoaded', () => {\n  window.app = new App();\n});\n"],"names":["User","id","username","email","password","role","createdAt","raw","next","Task","title","description","priority","category","dueDate","status","userId","tags","subtasks","reminder","updatedAt","subtaskIndex","completed","st","Category","name","color","Tag","Notification","message","type","read","taskId","ColorSettings","theme","primaryColor","secondaryColor","cardBg","textColor","borderColor","appBg","accentColor","Repo","o","users","tasks","categories","notifications","settings","user","adminUser","AuthService","userData","u","defaultCategories","cat","_","userWithoutPassword","updates","index","TaskService","t","data","task","NotificationService","fields","oldTask","statusText","total","pending","today","dueToday","CategoryService","c","TagService","tag","tagId","n","notification","tomorrow","ColorService","allSettings","root","metaTheme","presetName","presets","AppSettingsService","API","error","filters","searchTerm","a","b","priorityOrder","format","blob","csv","ToastManager","duration","container","toast","icon","removeToast","LoadingManager","spinner","App","prefs","quickActions","stats","completionRate","progressCircle","count","badge","e","element","btn","closeNotificationsBtn","addCategoryBtnModal","key","value","func","wait","timeout","args","later","result","confirmPassword","taskTitle","fromModal","modal","style","cancelBtn","confirmBtn","closeModal","suggestions","matchingTags","suggestion","createSuggestion","newTag","tagIdentifier","existingTag","tagElement","input","subtask","subtaskItem","categoriesWithCount","categoryItem","filterCategory","nextWeek","upcomingTasks","tasksByDate","sortedDates","date","dateItem","formattedDate","filterSelect","taskFormSelect","filterOption","formOption","nameInput","colorInput","newCategory","categoryId","newName","newColor","filterTags","option","tagItem","valueElement","previewSettings","defaultSettings","preset","newTheme","center","notificationItem","taskList","emptyState","sortPref","card","row","tasksTitle","totalTasks","mode","viewGrid","viewList","sortBy","direction","sortMessage","categoryColor","taskTags","dueDateInfo","progressIndicator","taskData","freshTask","tagsContainer","subtasksContainer","subtaskElement","toggleBtn","editBtn","deleteBtn","newStatus","url","hexcolor","r","g","dateString","diffMs","diffMins","diffHours","diffDays","text","div"],"mappings":"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"}